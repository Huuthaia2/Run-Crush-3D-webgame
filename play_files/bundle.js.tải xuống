!function(){"use strict";var e,t=Laya.ClassUtils.regClass;!function(e){!function(e){class i extends Laya.View{constructor(){super()}createChildren(){super.createChildren(),this.createView(i.uiView)}}i.uiView={type:"View",props:{width:720,top:0,runtime:"script/view/BattleUI.ts",right:0,left:0,height:1280,bottom:0},compId:2,child:[{type:"Box",props:{top:0,right:0,left:0,bottom:0},compId:49,child:[{type:"Box",props:{visible:!0,var:"ResultBox",top:0,right:0,left:0,bottom:0},compId:835,child:[{type:"Box",props:{width:720,visible:!1,var:"faileBox",height:600,centerY:-107,centerX:0},compId:851,child:[{type:"Image",props:{width:600,skin:"game/uibg.png",sizeGrid:"38,43,43,52",height:500,centerY:0,centerX:0},compId:852},{type:"Label",props:{y:77,wordWrap:!0,width:561,text:"挑战失败",styleSkin:"game/gamefail_title.png",stroke:2,height:136,fontSize:78,color:"#ffffff",centerX:0,bold:!0,align:"center"},compId:853},{type:"Label",props:{y:283,var:"failText",text:"关卡17失败了",fontSize:40,color:"#032b7f",centerX:0,bold:!0},compId:854},{type:"Label",props:{y:359,text:"重新再试一次吧！",fontSize:40,color:"#032b7f",centerX:0,bold:!0},compId:855},{type:"Image",props:{y:572,x:102.5,width:236,var:"goBackBtn",skin:"game/btn_blue_s.png",sizeGrid:"0,47,0,30",height:130},compId:857,child:[{type:"Label",props:{wordWrap:!0,width:198,valign:"middle",text:"算了",styleSkin:"game/text_giveup.png",height:115,fontSize:32,color:"#ffffff",centerY:0,centerX:0,bold:!0,align:"center"},compId:859}]},{type:"Image",props:{y:572,x:405.125,width:236,var:"AgBtn",skin:"game/btn_blue_s.png",sizeGrid:"0,47,0,30",height:130},compId:858,child:[{type:"Label",props:{text:"重试",styleSkin:"game/text_giveup.png",fontSize:32,color:"#ffffff",centerY:0,centerX:0,bold:!0},compId:944}]}]},{type:"Box",props:{width:720,visible:!1,var:"WinBox",height:600,centerY:-60,centerX:0},compId:861,child:[{type:"Image",props:{y:19,x:80,width:560,skin:"game/end_v_bg.png",sizeGrid:"38,43,43,52",height:562,centerY:0,centerX:0},compId:862},{type:"Image",props:{y:46,x:115,skin:"game/end_light.png",centerY:-9,centerX:0},compId:871},{type:"Image",props:{y:-56,x:34,width:660,skin:"game/end_banner.png",sizeGrid:"0,155,0,164",height:190,centerX:0},compId:872},{type:"Image",props:{y:-12,x:125,width:478,var:"NormalBox",height:100},compId:927,child:[{type:"Label",props:{y:21,x:5,width:320,text:"Hoàn thành",styleSkin:"game/text_level.png",height:58,fontSize:54,color:"#ffffff",bold:!0,align:"right"},compId:873}]},{type:"Image",props:{y:-12,x:125,width:478,visible:!1,var:"NeeBeeBox",height:100},compId:928,child:[{type:"Label",props:{y:0,x:0,wordWrap:!0,width:479,valign:"middle",text:"完成教程",styleSkin:"game/text_tutorial_done.png",sizeGrid:"0,0,0,0",height:96,fontSize:42,color:"#ffffff",bold:!0,align:"center"},compId:929}]},{type:"Image",props:{y:291,x:360,var:"BearBox",skin:"game/end_LevelComplete.png",centerY:-9,centerX:0,anchorY:.5,anchorX:.5},compId:870},{type:"FontClip",props:{x:428,width:162,var:"LevelCnt",value:"122",spaceX:-20,skin:"game/level_num.png",sheet:"0123456789",scaleY:1,scaleX:1,height:76,centerY:-262,align:"center"},compId:875},{type:"Label",props:{y:505,x:437,width:114,var:"GoldNum",text:"123",height:40,fontSize:40,color:"#ffffff",bold:!0},compId:878},{type:"Label",props:{y:505,x:88,width:247,var:"txt_award",text:"奖励:",height:40,fontSize:40,color:"#ffffff",bold:!0,align:"right"},compId:876},{type:"Image",props:{y:499,x:352,skin:"game/main_coin.png"},compId:877},{type:"Image",props:{y:592,x:233.5,width:289,var:"NextBtn",skin:"game/btn_green.png",sizeGrid:"0,71,0,42",height:113},compId:879,child:[{type:"Label",props:{y:32,text:"继续",styleSkin:"game/text_go_on.png",fontSize:48,color:"#ffffff",centerX:0,bold:!0},compId:880}]},{type:"Image",props:{y:592,x:233.5,width:289,visible:!1,var:"ADBtn",skin:"game/btn_blue_s.png",sizeGrid:"0,71,0,42",height:113},compId:937,child:[{type:"Image",props:{y:33,x:18,skin:"game/ad_video.png"},compId:939},{type:"Label",props:{y:35,x:75,width:209,valign:"middle",text:"双倍奖励",height:46,fontSize:24,bold:!0,align:"center"},compId:940}]},{type:"Image",props:{y:124,x:598,visible:!1,var:"CloseWinBtn",skin:"game/close_button.png"},compId:941}]},{type:"Image",props:{y:172,x:0,width:200,var:"GoldBox",skin:"game/main_coinbg.png",sizeGrid:"0,62,0,27",height:61},compId:907,child:[{type:"Image",props:{y:2.5,x:15,skin:"game/main_coin.png"},compId:908},{type:"Label",props:{y:11.5,x:76,width:108,var:"GoldCnt",text:"12356",height:30,fontSize:35,color:"#000000",align:"center"},compId:909}]},{type:"Image",props:{y:0,x:0,var:"BackBtn",skin:"game/game_restart.png"},compId:834},{type:"Image",props:{y:71,x:124,width:500,scaleY:.9,height:97},compId:836,child:[{type:"Image",props:{x:0,width:500,var:"blueMask",top:0,skin:"game/gamebar_blue.png",sizeGrid:"0,30,0,31",height:70},compId:842,child:[{type:"Image",props:{y:0,x:0,width:200,top:0,skin:"game/gamebar_mask.png",renderType:"mask",bottom:0},compId:936}]},{type:"Image",props:{x:0,width:500,var:"RedMask",top:0,skin:"game/gamebar_red.png",sizeGrid:"34,30,27,33",height:70},compId:843,child:[{type:"Image",props:{y:0,x:0,width:200,top:0,skin:"game/gamebar_mask.png",renderType:"mask",bottom:0},compId:935}]},{type:"Image",props:{x:0,width:500,var:"YellowMask",top:0,skin:"game/gamebar_yellow.png",sizeGrid:"31,26,19,37",height:70},compId:845,child:[{type:"Image",props:{y:0,x:0,width:200,top:0,skin:"game/gamebar_mask.png",renderType:"mask",bottom:0},compId:934}]},{type:"Image",props:{x:0,width:500,var:"OrangeMsk",top:0,skin:"game/gamebar_orange.png",sizeGrid:"27,37,29,36",height:70},compId:846,child:[{type:"Image",props:{y:0,x:0,width:200,top:0,skin:"game/gamebar_mask.png",renderType:"mask",bottom:0},compId:933}]},{type:"Image",props:{x:0,width:500,var:"GreenMask",top:0,skin:"game/gamebar_green.png",sizeGrid:"26,37,29,18",height:70},compId:849,child:[{type:"Image",props:{x:0,width:200,top:0,skin:"game/gamebar_mask.png",renderType:"mask",bottom:0},compId:932}]},{type:"FontClip",props:{y:10,x:250,width:130,var:"LevelNum",value:"2",spaceX:0,skin:"game/game_num.png",sheet:"0123456789",height:50,align:"center"},compId:912},{type:"Label",props:{y:13,x:134,var:"txt_lv",text:"关卡",styleSkin:"game/text_level.png",scaleY:.8,scaleX:.8,fontSize:58,color:"#ffffff",bold:!0},compId:920}]}]},{type:"Image",props:{visible:!1,var:"finger",skin:"game/guide_hand.png"},compId:921},{type:"Image",props:{width:600,visible:!1,var:"NewBeeTips",skin:"game/uibg.png",sizeGrid:"34,41,49,48",height:800,centerY:0,centerX:0},compId:923,child:[{type:"Label",props:{y:300,x:30,wordWrap:!0,width:540,text:"占领所有大楼即可获得胜利",stroke:2,height:163,fontSize:45,color:"#167ab2",align:"center"},compId:924},{type:"Image",props:{y:516,x:148.5,width:303,var:"NewBeeNextBtn",skin:"game/btn_blue_s.png",sizeGrid:"41,37,62,35",height:130},compId:925,child:[{type:"Label",props:{text:"好的",strokeColor:"#27c7cd",stroke:2,fontSize:60,color:"#ffffff",centerY:0,centerX:0},compId:926}]}]},{type:"Image",props:{x:304,visible:!1,var:"IceBtn",skin:"game/ice.png",bottom:100},compId:945,child:[{type:"Image",props:{y:87.5,x:82,skin:"game/ad_video.png",scaleY:.5,scaleX:.5},compId:946}]}]}],animations:[{nodes:[{target:826,keyframes:{y:[{value:48,tweenMethod:"linearNone",tween:!0,target:826,key:"y",index:0},{value:17.5,tweenMethod:"linearNone",tween:!0,target:826,key:"y",index:5},{value:130,tweenMethod:"linearNone",tween:!0,target:826,key:"y",index:15},{value:120,tweenMethod:"linearNone",tween:!0,target:826,key:"y",index:20},{value:60,tweenMethod:"linearNone",tween:!0,target:826,key:"y",index:25},{value:17,tweenMethod:"linearNone",tween:!0,target:826,key:"y",index:30},{value:134,tweenMethod:"linearNone",tween:!0,target:826,key:"y",index:40},{value:93,tweenMethod:"linearNone",tween:!0,target:826,key:"y",index:45},{value:17.5,tweenMethod:"linearNone",tween:!0,target:826,key:"y",index:50}],x:[{value:-9,tweenMethod:"linearNone",tween:!0,target:826,key:"x",index:0},{value:46,tweenMethod:"linearNone",tween:!0,target:826,key:"x",index:5},{value:217,tweenMethod:"linearNone",tween:!0,target:826,key:"x",index:15},{value:264,tweenMethod:"linearNone",tween:!0,target:826,key:"x",index:20},{value:289,tweenMethod:"linearNone",tween:!0,target:826,key:"x",index:25},{value:241,tweenMethod:"linearNone",tween:!0,target:826,key:"x",index:30},{value:57,tweenMethod:"linearNone",tween:!0,target:826,key:"x",index:40},{value:-12,tweenMethod:"linearNone",tween:!0,target:826,key:"x",index:45},{value:30,tweenMethod:"linearNone",tween:!0,target:826,key:"x",index:50}],visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:826,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:826,key:"visible",index:52}]}},{target:825,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:825,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:825,key:"visible",index:52}]}},{target:829,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:829,key:"visible",index:0},{value:!1,tweenMethod:"linearNone",tween:!1,target:829,key:"visible",index:52}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["game/uibg.png","game/gamefail_title.png","game/btn_blue_s.png","game/text_giveup.png","game/end_v_bg.png","game/end_light.png","game/end_banner.png","game/text_level.png","game/text_tutorial_done.png","game/end_LevelComplete.png","game/level_num.png","game/main_coin.png","game/btn_green.png","game/text_go_on.png","game/ad_video.png","game/close_button.png","game/main_coinbg.png","game/game_restart.png","game/gamebar_blue.png","game/gamebar_mask.png","game/gamebar_red.png","game/gamebar_yellow.png","game/gamebar_orange.png","game/gamebar_green.png","game/game_num.png","game/guide_hand.png","game/ice.png"],loadList3D:[]},e.BattleUIUI=i,t("ui.view.BattleUIUI",i);class a extends Laya.View{constructor(){super()}createChildren(){super.createChildren(),this.createView(a.uiView)}}a.uiView={type:"View",props:{width:720,top:0,runtime:"script/view/Dial.ts",right:0,left:0,height:1280,bottom:0},compId:2,child:[{type:"Image",props:{top:0,skin:"game/BlackMask.png",right:0,left:0,bottom:0,alpha:.8},compId:846},{type:"Box",props:{width:720,height:900,centerY:0,centerX:0},compId:49,child:[{type:"Image",props:{y:116,skin:"game/luckyPan_2.png",centerX:0},compId:824},{type:"Image",props:{y:-16,skin:"game/spin_title.png",centerX:0},compId:825},{type:"Image",props:{y:717,x:374,width:249,var:"WatchAdBtn",skin:"game/button_green.png",sizeGrid:"0,35,0,45",height:101},compId:829,child:[{type:"Image",props:{y:19.5,x:11,skin:"game/video.png"},compId:830},{type:"Image",props:{y:23.5,x:80,skin:"game/text_freeSpin.png"},compId:831}]},{type:"Image",props:{y:727.5,x:135,width:200,var:"CloseBtn",skin:"game/button_blue.png",height:80},compId:832,child:[{type:"Image",props:{y:19,x:20,skin:"game/text_noThanks.png",scaleY:.8,scaleX:.8},compId:847}]},{type:"Image",props:{y:242,x:320.5,skin:"game/BigCoin.png"},compId:833,child:[{type:"Label",props:{y:-56,x:-5,width:85,text:"20",height:38,fontSize:30,color:"#ffffff",bold:!0,align:"center"},compId:834}]},{type:"Image",props:{y:284,x:484.5,skin:"game/BigCoin.png",rotation:60},compId:835,child:[{type:"Label",props:{y:-56,x:-5,width:85,text:"100",height:38,fontSize:30,color:"#ffffff",bold:!0,align:"center"},compId:836}]},{type:"Image",props:{y:450,x:524,skin:"game/BigCoin.png",rotation:120},compId:837,child:[{type:"Label",props:{y:-56,x:-5,width:85,text:"200",height:38,fontSize:30,color:"#ffffff",bold:!0,align:"center"},compId:839}]},{type:"Image",props:{y:575,x:403.5,skin:"game/BigCoin.png",rotation:180},compId:838,child:[{type:"Label",props:{y:-56,x:-5,width:85,text:"50",height:38,fontSize:30,color:"#ffffff",bold:!0,align:"center"},compId:840}]},{type:"Image",props:{y:512,x:240.5,skin:"game/BigCoin.png",rotation:240},compId:841,child:[{type:"Label",props:{y:-56,x:-5,width:85,text:"400",height:38,fontSize:30,color:"#ffffff",bold:!0,align:"center"},compId:843}]},{type:"Image",props:{y:357,x:202.5,skin:"game/BigCoin.png",rotation:-60},compId:842,child:[{type:"Label",props:{y:-56,x:-5,width:85,text:"500",height:38,fontSize:30,color:"#ffffff",bold:!0,align:"center"},compId:844}]},{type:"Image",props:{y:419,x:353,width:120,var:"dialsss",skin:"game/luckyPan_1.png",scaleY:.6,scaleX:.6,rotation:0,pivotY:114,height:180,anchorX:.5},compId:845}]}],loadList:["game/BlackMask.png","game/luckyPan_2.png","game/spin_title.png","game/button_green.png","game/video.png","game/text_freeSpin.png","game/button_blue.png","game/text_noThanks.png","game/BigCoin.png","game/luckyPan_1.png"],loadList3D:[]},e.DialUI=a,t("ui.view.DialUI",a);class n extends Laya.View{constructor(){super()}createChildren(){super.createChildren(),this.createView(n.uiView)}}n.uiView={type:"View",props:{width:720,top:0,runtime:"script/view/GameUI.ts",right:0,left:0,height:1280,centerY:0,bottom:0},compId:2,child:[{type:"Box",props:{x:0,top:0,right:0,name:"TopBox",left:0,bottom:0,anchorX:0},compId:3,child:[{type:"Box",props:{width:100,name:"left",height:100},compId:54,child:[{type:"Box",props:{y:28,x:18,width:166,height:64},compId:49,child:[{type:"Image",props:{y:3,x:0,width:166,skin:"game/main_coinbg.png",sizeGrid:"0,30,0,27",height:61},compId:51},{type:"Image",props:{y:7.5,x:4,skin:"game/main_coin.png"},compId:50},{type:"Label",props:{y:16,x:56,width:101,var:"GoldCnt",valign:"middle",text:"120111",height:35,fontSize:25,color:"#562726",bold:!0,align:"center"},compId:52}]}]},{type:"Box",props:{width:100,visible:!0,name:"mid",height:100,centerY:0,centerX:0},compId:60,child:[{type:"Image",props:{y:496,width:299,var:"startbtn",skin:"game/BT4.png",sizeGrid:"0,51,0,62",height:78,centerX:8},compId:62,child:[{type:"Label",props:{valign:"middle",top:0,text:"开始游戏",right:0,left:0,fontSize:42,color:"#ffffff",bottom:0,bold:!0,align:"center"},compId:113}]},{type:"Image",props:{var:"SkinBtn",skin:"game/main_skin.png",centerY:0,centerX:-287},compId:56},{type:"Image",props:{y:391,x:-64,width:228,var:"Next",skin:"game/BT3.png",sizeGrid:"0,57,0,44",height:69},compId:91,child:[{type:"Image",props:{y:17,x:34,skin:"game/main_coin.png",scaleY:.7,scaleX:.7},compId:93},{type:"Label",props:{y:19.5,x:75,width:116,text:"1000",height:30,fontSize:32,font:"Arial",color:"#ffffff",align:"center"},compId:95},{type:"Label",props:{y:-30,text:"下一个区域",stroke:2,height:30,fontSize:25,font:"Arial",color:"#ffffff",centerX:0,align:"center"},compId:112}]},{type:"Image",props:{y:-312,x:-160,visible:!1,var:"LOGO",skin:"loading/logo.png"},compId:104},{type:"Image",props:{y:170,x:-308.5,var:"DoubleBtn",skin:"game/double.png"},compId:105,child:[{type:"Image",props:{y:87,x:83,skin:"game/ad_video.png",scaleY:.5,scaleX:.5},compId:108}]},{type:"Image",props:{y:170,x:291,var:"IceBtn",skin:"game/ice.png"},compId:106,child:[{type:"Image",props:{y:87.5,x:82,skin:"game/ad_video.png",scaleY:.5,scaleX:.5},compId:107}]}]},{type:"Box",props:{visible:!1,var:"Tips",top:0,right:0,left:0,bottom:0},compId:96,child:[{type:"Image",props:{width:680,skin:"game/uibg.png",sizeGrid:"42,37,40,46",height:798,centerY:1,centerX:0},compId:97,child:[{type:"Image",props:{y:153,x:21,var:"tips_img",skin:"game/tutorial_3.png",centerY:-63,centerX:0},compId:99},{type:"Image",props:{y:618,x:197.5,width:285,var:"tips_close",skin:"game/btn_blue_s.png",sizeGrid:"0,47,0,37",height:130},compId:100,child:[{type:"Label",props:{valign:"middle",top:0,text:"好的",right:0,left:0,fontSize:58,color:"#ffffff",bottom:0,bold:!0,align:"center"},compId:111}]},{type:"Label",props:{y:529,wordWrap:!0,width:665,var:"tips_txt",valign:"middle",text:"三角形双倍攻击力",height:72,fontSize:32,color:"#004590",centerX:0,bold:!0,align:"center"},compId:103}]}]},{type:"Box",props:{y:126,x:27,var:"btn_music"},compId:114,child:[{type:"Image",props:{skin:"game/main_btnbg.png"},compId:115},{type:"Image",props:{y:0,x:0,var:"btn_on",skin:"game/main_music_on.png",centerY:0,centerX:0},compId:116},{type:"Image",props:{y:0,x:0,visible:!1,var:"btn_off",skin:"game/main_music_off.png",centerY:0,centerX:0},compId:117}]}]}],loadList:["game/main_coinbg.png","game/main_coin.png","game/BT4.png","game/main_skin.png","game/BT3.png","loading/logo.png","game/double.png","game/ad_video.png","game/ice.png","game/uibg.png","game/tutorial_3.png","game/btn_blue_s.png","game/main_btnbg.png","game/main_music_on.png","game/main_music_off.png"],loadList3D:[]},e.GameUIUI=n,t("ui.view.GameUIUI",n);class s extends Laya.View{constructor(){super()}createChildren(){super.createChildren(),this.createView(s.uiView)}}s.uiView={type:"View",props:{width:720,top:0,runtime:"script/view/LoadingUI.ts",right:0,left:0,height:1280,bottom:0},compId:2,child:[{type:"Box",props:{top:0,right:0,left:0,bottom:0},compId:49,child:[{type:"Image",props:{top:0,skin:"loading/loadbg.jpg",right:0,left:0,bottom:0},compId:18},{type:"Image",props:{visible:!1,skin:"loading/logo.png",centerY:-420,centerX:0},compId:51},{type:"Image",props:{skin:"loading/loadbar1.png",sizeGrid:"0,0,0,0",centerY:440,centerX:0},compId:53},{type:"Label",props:{var:"txt_loding",text:"占领城市中...",strokeColor:"#449dff",stroke:1,fontSize:50,color:"#ffffff",centerY:383,centerX:0,bold:!0},compId:57}]}],loadList:["loading/loadbg.jpg","loading/logo.png","loading/loadbar1.png"],loadList3D:[]},e.LoadingUI=s,t("ui.view.LoadingUI",s);class o extends Laya.View{constructor(){super()}createChildren(){super.createChildren(),this.createView(o.uiView)}}o.uiView={type:"View",props:{width:720,top:0,runtime:"script/view/SevenDay.ts",right:0,left:0,height:1280,bottom:0},compId:2,child:[{type:"Box",props:{top:0,right:0,left:0,bottom:0},compId:49,child:[{type:"Image",props:{top:0,skin:"game/BlackMask.png",right:0,left:0,bottom:0},compId:883},{type:"Image",props:{y:86,width:580,skin:"game/singUI_BG.png",sizeGrid:"138,52,62,40",height:1016,centerX:0},compId:824},{type:"Image",props:{y:106,skin:"game/sign_title.png",centerX:0},compId:825},{type:"Image",props:{y:120,x:578,var:"CloseBtn",skin:"game/close.png"},compId:826},{type:"Image",props:{y:106,skin:"game/sign_title.png",centerX:0},compId:827},{type:"Image",props:{y:1061,width:278,var:"NormalBtn",skin:"game/button_blue.png",sizeGrid:"0,83,0,39",scaleY:.5,scaleX:.5,height:155,centerX:-103},compId:885,child:[{type:"Image",props:{y:57,skin:"game/sign_claim.png",centerX:0},compId:887}]},{type:"Image",props:{y:1061,width:139,var:"GetAdBtn",skin:"game/button_green.png",sizeGrid:"0,83,0,39",height:77.5,centerX:137},compId:876,child:[{type:"Image",props:{y:22.25,x:13,width:39,skin:"game/video.png",height:33},compId:877},{type:"Label",props:{y:24,x:54,width:76,valign:"middle",text:"双倍领取",height:28,fontSize:20,color:"#ffffff",align:"center"},compId:888}]},{type:"Image",props:{y:937,x:1113,width:37,var:"UseADBtn",height:34},compId:882,child:[{type:"Image",props:{y:-1,x:2,skin:"game/sign_videoTickBG.png"},compId:880},{type:"Image",props:{y:5,x:4,var:"UseADImg",skin:"game/sign_videoTick.png"},compId:881}]},{type:"Image",props:{y:941,x:1171,skin:"game/text_addouble.png"},compId:879},{type:"Image",props:{y:258,x:111,var:"Day1",skin:"game/signBG.png",sizeGrid:"0,0,0,0",scaleY:1.2,scaleX:1.2},compId:828,child:[{type:"Image",props:{y:-36,x:7,skin:"game/sign_day1.png"},compId:831},{type:"Image",props:{y:5,x:4,width:118,skin:"game/BlackMask.png",name:"msk",height:118},compId:832},{type:"Image",props:{y:6,x:24.5,skin:"game/BigCoin.png"},compId:829},{type:"Image",props:{y:37.5,x:70,skin:"game/signde_tick.png",name:"getImg"},compId:833},{type:"Label",props:{y:93,x:0,width:123,text:"300",height:30,fontSize:30,color:"#ffffff",align:"center"},compId:830}]},{type:"Image",props:{y:258,x:288,var:"Day2",skin:"game/signBG.png",sizeGrid:"0,0,0,0",scaleY:1.2,scaleX:1.2},compId:840,child:[{type:"Image",props:{y:-36,x:7,skin:"game/sign_day2.png"},compId:841},{type:"Image",props:{y:5,x:4,width:118,skin:"game/BlackMask.png",name:"msk",height:118},compId:842},{type:"Image",props:{y:6,x:24.5,skin:"game/BigCoin.png"},compId:843},{type:"Image",props:{y:37.5,x:70,skin:"game/signde_tick.png",name:"getImg"},compId:844},{type:"Label",props:{y:93,x:0,width:123,text:"500",height:30,fontSize:30,color:"#ffffff",align:"center"},compId:845}]},{type:"Image",props:{y:258,x:466,var:"Day3",skin:"game/signBG.png",sizeGrid:"0,0,0,0",scaleY:1.2,scaleX:1.2},compId:846,child:[{type:"Image",props:{y:-36,x:7,skin:"game/sign_day3.png"},compId:847},{type:"Image",props:{y:5,x:4,width:118,skin:"game/BlackMask.png",name:"msk",height:118},compId:848},{type:"Image",props:{y:6,x:24.5,skin:"game/BigCoin.png"},compId:849},{type:"Image",props:{y:38.5,x:70,skin:"game/signde_tick.png",name:"getImg"},compId:850},{type:"Label",props:{y:94,x:0,width:123,text:"550",height:30,fontSize:30,color:"#ffffff",align:"center"},compId:851}]},{type:"Image",props:{y:482,x:111,var:"Day4",skin:"game/signBG.png",sizeGrid:"0,0,0,0",scaleY:1.2,scaleX:1.2},compId:852,child:[{type:"Image",props:{y:-36,x:7,skin:"game/sign_day4.png"},compId:855},{type:"Image",props:{y:5,x:4,width:118,skin:"game/BlackMask.png",name:"msk",height:118},compId:856},{type:"Image",props:{y:6,x:24.5,skin:"game/BigCoin.png"},compId:857},{type:"Image",props:{y:37.5,x:70,skin:"game/signde_tick.png",name:"getImg"},compId:858},{type:"Label",props:{y:93,x:0,width:123,text:"600",height:30,fontSize:30,color:"#ffffff",align:"center"},compId:859}]},{type:"Image",props:{y:484,x:288,var:"Day5",skin:"game/signBG.png",sizeGrid:"0,0,0,0",scaleY:1.2,scaleX:1.2},compId:853,child:[{type:"Image",props:{y:-36,x:7,skin:"game/sign_day5.png"},compId:860},{type:"Image",props:{y:5,x:4,width:118,skin:"game/BlackMask.png",name:"msk",height:118},compId:861},{type:"Image",props:{y:6,x:24.5,skin:"game/BigCoin.png"},compId:862},{type:"Image",props:{y:37.5,x:70,skin:"game/signde_tick.png",name:"getImg"},compId:863},{type:"Label",props:{y:93,x:0,width:123,text:"800",height:30,fontSize:30,color:"#ffffff",align:"center"},compId:864}]},{type:"Image",props:{y:484,x:466,var:"Day6",skin:"game/signBG.png",sizeGrid:"0,0,0,0",scaleY:1.2,scaleX:1.2},compId:854,child:[{type:"Image",props:{y:-36,x:7,skin:"game/sign_day6.png"},compId:865},{type:"Image",props:{y:5,x:4,width:118,skin:"game/BlackMask.png",name:"msk",height:118},compId:866},{type:"Image",props:{y:6,x:24.5,skin:"game/BigCoin.png"},compId:867},{type:"Image",props:{y:37.5,x:70,skin:"game/signde_tick.png",name:"getImg"},compId:868},{type:"Label",props:{y:93,x:0,width:123,text:"1000",height:30,fontSize:30,color:"#ffffff",align:"center"},compId:869}]},{type:"Image",props:{y:700,x:288,var:"Day7",skin:"game/signBG.png",sizeGrid:"0,0,0,0",scaleY:1.2,scaleX:1.2},compId:870,child:[{type:"Image",props:{y:-36,x:7,skin:"game/sign_day7.png"},compId:871},{type:"Image",props:{y:5,x:4,width:118,skin:"game/BlackMask.png",name:"msk",height:118},compId:872},{type:"Image",props:{y:6,x:24.5,skin:"game/BigCoin.png"},compId:873},{type:"Image",props:{y:37.5,x:70,skin:"game/signde_tick.png",name:"getImg"},compId:874},{type:"Label",props:{y:93,x:0,width:123,text:"1200",height:30,fontSize:30,color:"#ffffff",align:"center"},compId:875}]},{type:"Box",props:{y:861,x:178,width:400,var:"NativeBox",height:200},compId:892}]}],loadList:["game/BlackMask.png","game/singUI_BG.png","game/sign_title.png","game/close.png","game/button_blue.png","game/sign_claim.png","game/button_green.png","game/video.png","game/sign_videoTickBG.png","game/sign_videoTick.png","game/text_addouble.png","game/signBG.png","game/sign_day1.png","game/BigCoin.png","game/signde_tick.png","game/sign_day2.png","game/sign_day3.png","game/sign_day4.png","game/sign_day5.png","game/sign_day6.png","game/sign_day7.png"],loadList3D:[]},e.SevenDayUI=o,t("ui.view.SevenDayUI",o);class l extends Laya.View{constructor(){super()}createChildren(){super.createChildren(),this.createView(l.uiView)}}l.uiView={type:"View",props:{width:720,top:0,runtime:"script/view/SkinUI.ts",right:0,left:0,height:1280,bottom:0},compId:2,child:[{type:"Box",props:{top:0,right:0,left:0,bottom:0},compId:49,child:[{type:"Image",props:{width:720,skin:"game/skin_uibg.png",sizeGrid:"138,52,62,40",height:700,centerX:0,bottom:0},compId:824,child:[{type:"Image",props:{y:-107,x:609,var:"CloseBtn",skin:"game/skin_close.png"},compId:826},{type:"Image",props:{y:-211,x:0,width:205,var:"GetAD",skin:"game/btn_purple.png",sizeGrid:"0,45,0,24",height:87},compId:879,child:[{type:"Image",props:{y:19,x:19,skin:"game/ad_video.png"},compId:916},{type:"Image",props:{y:16,x:143,skin:"game/main_coin.png"},compId:917},{type:"Label",props:{y:27.5,x:74,width:73,text:"+150",height:32,fontSize:32,color:"#ffffff",align:"center"},compId:918}]},{type:"Box",props:{y:-107,x:0,width:213,var:"SkinBox",scaleY:1,scaleX:.95,height:107},compId:893,child:[{type:"Image",props:{y:0,skin:"game/skin_tap2.png",centerX:0},compId:825},{type:"Image",props:{skin:"game/skin_tap1.png",name:"light"},compId:898},{type:"Image",props:{y:12,x:72,skin:"game/skintap_head.png"},compId:901}]},{type:"Box",props:{y:-107,x:203,width:213,var:"AttackBox",scaleX:.95,height:107},compId:894,child:[{type:"Image",props:{y:0,skin:"game/skin_tap2.png",centerX:0},compId:895},{type:"Image",props:{skin:"game/skin_tap1.png",name:"light"},compId:899},{type:"Image",props:{y:14,x:68,skin:"game/skintap_sword.png"},compId:902}]},{type:"Box",props:{y:-107,x:406,width:213,var:"Shield",scaleX:.95,height:107},compId:896,child:[{type:"Image",props:{y:0,skin:"game/skin_tap2.png",centerX:0},compId:897},{type:"Image",props:{skin:"game/skin_tap1.png",name:"light"},compId:900},{type:"Image",props:{y:15.5,x:73,skin:"game/skintap_shield.png"},compId:903}]},{type:"List",props:{y:61,x:50,width:620,var:"SkinArr",spaceY:2,spaceX:7,height:315},compId:904,child:[{type:"Box",props:{width:154,scaleY:.9,scaleX:.9,renderType:"render",height:154},compId:905,child:[{type:"Image",props:{y:0,x:0,skin:"game/skin_bg1.png",name:"iconbg"},compId:907},{type:"Image",props:{y:0,x:0,top:0,skin:"game/head1.png",name:"icon"},compId:906},{type:"Image",props:{y:0,x:0,skin:"game/skin_bgmask.png",name:"bg"},compId:908,child:[{type:"Box",props:{y:0,x:0,width:154,name:"AdBox",height:154},compId:912,child:[{type:"Image",props:{y:9,skin:"game/ad_video.png",centerX:0},compId:909},{type:"Label",props:{y:61,x:16,wordWrap:!0,width:127,valign:"middle",text:"免费获得",height:75,fontSize:25,color:"#ffffff",bold:!0,align:"center"},compId:911}]},{type:"Box",props:{y:0,x:0,width:154,name:"GoldBox",height:154},compId:913,child:[{type:"Image",props:{y:91,x:15,skin:"game/main_coin.png"},compId:914},{type:"Label",props:{y:108.5,x:61,width:93,text:"250",height:25,fontSize:25,color:"#ffffff",bold:!0,align:"center"},compId:915}]}]}]}]}]}]}],loadList:["game/skin_uibg.png","game/skin_close.png","game/btn_purple.png","game/ad_video.png","game/main_coin.png","game/skin_tap2.png","game/skin_tap1.png","game/skintap_head.png","game/skintap_sword.png","game/skintap_shield.png","game/skin_bg1.png","game/head1.png","game/skin_bgmask.png"],loadList3D:[]},e.SkinUIUI=l,t("ui.view.SkinUIUI",l)}(e.view||(e.view={}))}(e||(e={}));class i extends Laya.EventDispatcher{constructor(){super()}}let a={QQAd:"QQAd",TouTAd:"TouTAd",OPAd:"OPPOAd",VivoAd:"VivoAd",WXAd:"WXAd",Web:"Web",P4399Ad:"P4399Ad",XiaoMiAd:"XiaoMiAd"};var n={Platform:a.Web,AppID:"1110113653",Version:"1.2",hotVersion:"hotVersion.json",CDN:"https://ssdzz-1256732840.cos.ap-guangzhou.myqcloud.com/",SourceOpenid:"",Openid:"",Session_key:"",Channel:"",HttpServer:"",NetLog:!1};class s{isLogin(){return!0}login(e){e&&e()}getconfig(e){e&&e()}launchInfo(){return{}}startLoading(e){return!0}onLoading(e){}authenticLogin(e,t,i){void 0!==e&&e(!0)}hideAuthenticLoginBtn(){}createFeedbackButton(e){}setFeedbackButtonVisible(e){}openCustomerServiceConversation(e){}authorize(e,t){}isAuthorize(e){e&&e(!0)}destroyButton(){}onShow(e){}onHide(e){}onShare(e){}isSharing(){}destroyNativeAd(){}navigateToMiniProgram(e){}getLaunchOptionsSync(){}createBannerAd(e){}closeBannerAd(){}setBannerVisible(e){}createRewardedVideoAd(e,t,i,a){t&&t(!0)}startRecorderVedio(){}stopRecorderVedio(){}clipVideo(e){}createAppBox(){}createInterstitalAd(){}vibrateShort(){}vibrateLong(){}setisOpenVibration(e){}createNativeAd(e,t){t&&t(!0)}createNativeAdClick(e){}createInnerAudioContext(){}setUserCloudStorage(e){}getOpenDataContext(){}postMessage(e){}onMessage(e){}getSystemInfoSync(){return{brand:"PC",model:"web",benchmarkLevel:100}}submitRankScore(){}canPlayAd(){}initializeAsync(e){e()}}class o{static initializeAsync(e){window.platform.initializeAsync(e)}static login(e){window.platform.login(e)}static getZip(e){window.platform.getZip(e)}static launchInfo(){window.platform.launchInfo()&&(o.language=window.platform.launchInfo())}static onLoading(){window.platform.onLoading()}static getUserInfo(e){window.platform.getUserInfo({withCredentials:!0,success:function(t){var i=t.userInfo;e&&e(i)}})}static authorize(e,t){n.Platform==a.QQAd?window.platform.getSystemInfo({success:function(i){var a=i.windowWidth/Laya.stage.designWidth,n=e.x*a,s=e.y*a,o=window.platform.createUserInfoButton({type:"text",text:"",style:{left:n,top:s,width:e.width*a,height:e.height*a,lineHeight:40,textAlign:"center",fontSize:30,borderRadius:4,opacity:.1}});this.button||(this.button=o),o.onTap(function(e){if(console.log("授权信息：res = "+JSON.stringify(e)),e.userInfo){var i={name:e.userInfo.nickName,url:e.userInfo.avatarUrl};console.log(" 用户授权成功：userInfo.nickName = "+i.name+"\tuserInfo.avatarUrl = "+i.url),t&&t(!0,i)}else console.log("微信返回的userInfo 为空 ！"),t&&t(!1);o.destroy()})}}):(n.Platform,a.P4399Ad)}static isAuthorize(e){n.Platform==a.QQAd?window.platform.getSetting({success:function(t){t.authSetting["scope.userInfo"]?e&&e(!0):e&&e(!1)}}):(n.Platform,a.P4399Ad)}static destroyButton(){window.platform.destroyButton()}static onShow(e){n.Platform==a.QQAd&&window.platform.onShow(function(t){e&&e(t)})}static onHide(e){n.Platform==a.QQAd&&window.platform.onHide(function(t){e&&e(t)})}static onShare(e){n.Platform==a.QQAd?window.platform.shareAppMessage({title:e.title,imageUrl:e.imageUrl,success:function(t){e.success&&e.success(t)},fail:function(t){e.fail&&e.fail(t)},complete:function(e){}}):n.Platform==a.P4399Ad&&window.platform.share()}static navigateToMiniProgram(e){window.platform.navigateToMiniProgram(e)}static createBannerAd(){"undefined"!=typeof wx&&window.platform.createBannerAd()}static showBanner(){o.bannerAd&&o.bannerAd.show()}static bannerOnError(e){this.finishCallback(e.errCode)}static bannerOnLoad(){this.finishCallback(0)}static closeBannerAd(){window.platform.closeBannerAd()}static setBannerVisible(e){window.platform.setBannerVisible(e)}static closeRewardVedioAd(e=!1,t=null,i=null){this.videoAd&&(this.videoAd.offLoad(),this.videoAd.offError(),this.videoAd.offClose(),this.videoAd=null,t&&t(e,i))}static createRewardedVideoAd(e){window.platform.createRewardedVideoAd(e)}static showRewardedVideoAd(){this.videoAd&&this.videoAd.load().then(()=>{var e=this.videoAd.show();console.log("视频广告显示结果",e)})}static startRecorderVedio(){window.platform.startRecorderVedio()}static stopRecorderVedio(){window.platform.stopRecorderVedio()}static clipVideo(e){window.platform.clipVideo(e)}static createAppBox(e){n.Platform==a.QQAd?(this.closeAppBox(),this.appBox=window.platform.createAppBox({adUnitId:e}),null==this.appBox?console.error("创建广告盒子失败"):(this.appBox.onClose(e=>{this.closeAppBox()}),this.appBox.load().then(()=>{var e=this.appBox.show();console.log("广告盒子显示结果",e)}))):n.Platform==a.P4399Ad&&window.platform.showRecommend()}static closeAppBox(){null!=this.appBox&&(this.appBox.offLoad(),this.appBox.offError(),this.appBox.offClose(),this.appBox=null)}static vibrateShort(){"undefined"!=typeof wx&&wx.vibrateShort(null)}static vibrateLong(){null!=window.platform.vibrateLong&&window.platform.vibrateLong({})}static setisOpenVibration(e){null!=window.platform.setisOpenVibration&&window.platform.setisOpenVibration(e)}static createInnerAudioContext(){return window.platform.createInnerAudioContext()}static setUserCloudStorage(e){n.Platform==a.QQAd?window.platform.setUserCloudStorage({KVDataList:[{key:"killCount",value:e.toString()}],success:function(e){console.log("setUserCloudStorage success",e)},fail:function(e){console.log("setUserCloudStorage fail",e)}}):n.Platform==a.P4399Ad&&e>0&&window.platform.submitRankScore(39,e,null)}static postMessage(e){window.platform.postMessage(e)}static getconfig(e){return window.platform.getconfig(e)}static getSystemInfoSync(){if(n.Platform==a.QQAd)return window.platform.getSystemInfoSync()}static saveAppToDesktop(e){n.Platform==a.QQAd?window.platform.saveAppToDesktop(e):n.Platform==a.P4399Ad&&window.platform.showRecommend()}static canPlayAd(e){window.platform.canPlayAd(t=>{e&&e(t.canPlayAd,t.remain)})}static interstitialAd(){window.platform.interstitialAd()}static showNativeAd(e,t){"undefined"!=typeof qg&&(qg.getSystemInfoSync().platformVersionCode<1053||(console.log("平台号大于1053"),o.nativeAd=qg.createNativeAd({posId:t}),function(){let e=o.nativeAd.load();e&&e.then(e=>{console.log("原生插屏加载完成",JSON.stringify(e))}).catch(e=>{console.log("加载失败",JSON.stringify(e))})}(),o.nativeAd.onLoad(function(t){console.log("原生插屏加载完成",JSON.stringify(t)),t&&t.adList?(o.nativeCurrentAd=t.adList.pop(),e(o.nativeCurrentAd),o.nativeAd.reportAdShow({adId:o.nativeCurrentAd.adId.toString()})):e(!1)})))}static showNativeAd2(e,t){"undefined"!=typeof qg&&(qg.getSystemInfoSync().platformVersionCode<1053||(console.log("平台号大于1053"),o.nativeAd2=qg.createNativeAd({posId:t}),function(){let e=o.nativeAd2.load();e&&e.then(e=>{console.log("原生广告加载完成",JSON.stringify(e))}).catch(e=>{console.log("加载失败",JSON.stringify(e))})}(),o.nativeAd2.onLoad(function(t){console.log("原生广告加载完成",JSON.stringify(t)),t&&t.adList?(o.nativeCurrentAd2=t.adList.pop(),e(o.nativeCurrentAd2),o.nativeAd2.reportAdShow({adId:o.nativeCurrentAd2.adId.toString()})):e(!1)})))}static createNativeAdClick(e){console.log(e.adId.toString()),o.nativeAd.reportAdClick({adId:e.adId.toString()})}static createNativeAdClick2(e){console.log(e.adId.toString()),o.nativeAd2.reportAdClick({adId:e.adId.toString()})}static destroyNativeAd(){window.platform.destroyNativeAd()}static createNativeAd(e,t){window.platform.createNativeAd(e,t)}}o.bannertime=0,o.button=null,o.Videotime=0,o.language="en-us";class l{constructor(){this._zOrder=1e3,this._tipsZOrder=1e5,this._uiArray=[]}toUI(e,t=null){if(null!=e&&null!=e){for(let e=this._uiArray.length-1;e>=0;e--){let t=this._uiArray[e];this.onUIClose(t,null)}this._uiArray.length=0,this.openUI(e,t,!0)}}closeUI(e,t=null){if(null==e||null==e)return;let i;for(let a=this._uiArray.length-1;a>=0;a--)if((i=this._uiArray[a]).uiconfig==e){this.onUIClose(i,t),this._uiArray.splice(a,1);break}this.checkBanner(i,!1)}openUI(e,t=null,i=!0){null!=e&&null!=e&&(e.res&&e.res.length>0?Laya.loader.load(e.res,Laya.Handler.create(this,function(){this.createUI(e,t,i)})):this.createUI(e,t,i))}openUniqueUI(e,t=null,i=!0){if(null==e||null==e)return;let a=this.findUI(e);if(a)return null!=t&&a.updateData(t),void(a.visible=i);this.openUI(e,t,i)}createUI(e,t=null,i=!0){if(null==e||null==e)return;let a=Laya.ClassUtils.getRegClass(e.class);if(null==a)return void console.error("openUI error",e);let n=new a;n.uiconfig=e,null!=t&&n.updateData(t),n.zOrder=this._zOrder++,n.visible=i,Laya.stage.addChild(n),this._uiArray.push(n),n.visible&&(Laya.timer.once(500,this,this.checkBanner,[n,!0]),this.checkBanner(n,!0),e.tween&&(Laya.Tween.from(n,{scaleX:.8,scaleY:.8},200,Laya.Ease.backOut),n.uitween=e.tween))}onUIClose(e,t){e.uitween?Laya.Tween.to(e,{scaleX:.8,scaleY:.8},200,Laya.Ease.backIn,Laya.Handler.create(this,function(){this.destroyUI(e),t&&t.method()})):(this.destroyUI(e),t&&t.method())}destroyUI(e){if(this.checkBanner(e,!1),e._aniList){let t;for(let i=0;i<e._aniList.length;i++)(t=e._aniList[i])&&t.clear&&t.clear()}Laya.timer.clearAll(e),Laya.stage.removeChild(e),e.close(),e.destroy(!0)}findUI(e){if(null!=e&&null!=e){for(let t=this._uiArray.length-1;t>=0;t--){let i=this._uiArray[t];if(i.uiconfig==e)return i}return null}}setUIVisible(e,t){if(null==e||null==e)return;let i=this.findUI(e);i&&(i.visible=t,t&&(i.zOrder=this._zOrder++),this.checkBanner(i,t))}setTop(e){if(null==e||null==e)return;let t=this.findUI(e);t&&(t.zOrder=this._zOrder++)}showTips(e){let t,i=this._arrTips;if(null==i){i=[];let e=new Laya.Box;Laya.stage.addChild(e),e.zOrder=this._tipsZOrder;for(let a=0;a<3;a++){let a=new Laya.Box;a.anchorX=a.anchorY=.5,a.centerX=0;let n=new Laya.Image("game/tips_bg.png");n.sizeGrid="0,45,0,55",a.addChild(n),n.centerX=0,n.width=500,n.height=80,t=new Laya.Text,a.addChild(t),t.fontSize=36,t.color="#FFFFFF",t.width=800,t.height=50,t.y=15,t.align="center",t.valign="middle",t.centerX=0,i.push(t),e.addChild(a),a.visible=!1}this._arrTips=i,e.width=600,e.centerX=0,e.centerY=-100}if(0==i.length)return;(t=i.shift()).text=e;t.color="#FFFFFF";let a=t.parent;a.visible=!0,a.scale(.8,.8),a.alpha=1,Laya.Tween.to(a,{scaleX:1,scaleY:1},200,Laya.Ease.backOut,Laya.Handler.create(this,function(e){Laya.timer.once(1400,this,function(){Laya.Tween.to(a,{alpha:0},400,null,Laya.Handler.create(this,function(){e.parent.visible=!1,i.push(e)}))})},[t]))}checkBanner(e,t,i=null){if(null==e||null==e||null==e.uiconfig||null==e.uiconfig)return;let a=e.uiconfig.id;if(t){let t=e.uiconfig.adunit;if(t&&t.length>0){t[Math.floor(t.length*Math.random())];e.showBanner=!0;for(let t=this._uiArray.length-1;t>=0;t--)(e=this._uiArray[t])&&(e.showBanner=!1)}else o.setBannerVisible(!1)}else{let t=!0;for(let i=this._uiArray.length-1;i>=0;i--)if(e=this._uiArray[i]){if(a=e.uiconfig.id,e.visible&&e.uiconfig.adunit&&e.uiconfig.adunit.length>0){t=!1;break}if(e.showBanner){t=!0;break}}t?(o.setBannerVisible(!1),e.showBanner=!1):e.showBanner||(o.setBannerVisible(!0),e.uiconfig.adunit&&e.uiconfig.adunit.length>0&&(e.showBanner=!0))}}}let r={Res_Load_Progress:"Res_Load_Progress",Res_Load_Complete:"Res_Load_Complete",GameIsReady:"GameIsReady",Guide_UpdateStep:"Guide_UpdateStep",Battle_AddPlayer:"Battle_AddPlayer",Battle_DelPlayer:"Battle_DelPlayer",Battle_AddScore:"Battle_AddScore",Battle_AiAddScore:"Battle_AiAddScore",Battle_AlertInfo:"Battle_AlertInfo",Skin_ClickItem:"Skin_ClickItem",ClickItem:"ClickItem",ClickNativeItem:"ClickNativeItem"},h={Ai:"res/json/Ai.json",Badge:"res/json/Badge.json",Global:"res/json/Global.json",Items:"res/json/Items.json",Map:"res/json/Map.json",Robot:"res/json/Robot.json",Skin:"res/json/Skin.json",SnakeExp:"res/json/SnakeExp.json",Level:"res/json/Level.json",Fight:"res/json/Fight.json"},d={Forever:0,Deadline:1},g="516d7b7267d6401cd23fb4a9374448d7",c="7d75c79a0c3e97d525a7ad97d560821f",p="65ac6c1e4cb6c283e42c69c637ed5ab1",m={ColorObj:"prefab/ColorObj.prefab",Heads:"game/prefabs/Conventional/heads.lh",Bomb:"game/particle/Conventional/Bomb.lh",Crown:"game/prefabs/Conventional/crown.lh",Skull:"game/prefabs/Conventional/skull.lh"},u={Bgm:"sound/bgm.mp3",BtnClick:"sound/2.mp3",CarConstruct:"sound/3.mp3",EngineLoop:"sound/4.mp3",Complete:"sound/5.mp3",ClearDriveway:"sound/6.mp3",Snowpile3:"sound/7.mp3",CarDriveOff1:"sound/8.mp3",Drag1:"sound/9.mp3",FollowerHorn2:"sound/10.mp3",Sled1:"sound/11.mp3",Garbage1:"sound/12.mp3",BreakGate1:"sound/13.mp3",SnowMan2:"sound/14.mp3",SledDestroy2:"sound/15.mp3",Car1:"sound/16.mp3",cattle:"sound/17.mp3",Elk:"sound/18.mp3",RoadBlocker1:"sound/19.mp3",CarCrash:"sound/20.mp3",Car3:"sound/21.mp3",MetalPole1:"sound/22.mp3",GreatSnowman:"sound/23.mp3"};class f{constructor(){}preLoadRes(){Laya.loader.create(f.PreloadRes,Laya.Handler.create(this,this.onPreLoadResComplete),Laya.Handler.create(this,this.onPreLoadResProgress))}onPreLoadResComplete(){console.log("########## onPreLoadResComplete"),D.CfgMgr.initConfigs(),D.SceneMgr.Initialization(),D.EventMgr.event(r.Res_Load_Complete,[100])}onPreLoadResProgress(e){D.EventMgr.event(r.Res_Load_Progress,e)}GetRes(e){var t=Laya.loader.getRes(e);return null==t&&console.error("资源未加载/已释放:",e),t}GetJson(e){var t="res/json/"+e+".json";return this.GetRes(t)}GetPartical(e){var t="game/particle/Conventional/"+e+".lh",i=this.GetRes(t);return null!=i?i.getChildAt(0):null}GetPrefab(e){var t="game/player/Conventional/"+e+".lh",i=this.GetRes(t);return null!=i?i.getChildAt(0):null}GetScene(e){var t="game/scenes/Conventional/"+e+".lh",i=this.GetRes(t);return null!=i?i.getChildAt(0):null}GetTestPFB(e){var t="test/prefabs/Conventional/"+e+".lh",i=this.GetRes(t);return null!=i?i.getChildAt(0):null}}f.PreloadRes=[{url:"res/atlas/game.atlas",type:Laya.Loader.ATLAS},{url:"res/cfg/CityLevelCfg.json",type:Laya.Loader.JSON},{url:"res/cfg/LevelUpCfg.json",type:Laya.Loader.JSON}];class y{constructor(){this.muiceOpen=!1,this.IsReady=!1,this.PlayGameCnt=0,this.openScene=null,this.clickAD=!1,this.playMuisc=!0}initConfigs(){this.aiCfg=["LiNdA琳达","@榕","zamusu","猪女孩","小丸子好萌","微微一笑很倾城","殷歌妈妈","jeffennie","李连和","回眸一笑闪嘞腰","瘦身兼美颜顾问","王子凡妈妈","翠竹","自由自在","小孙","老季批发部","安琪","家人们呐","少年","中国速度","最天使"],this.globalCfg=[2e3,3500,5e3,5e3,5e3],this.CityLevelCfg=Laya.loader.getRes("res/cfg/CityLevelCfg.json"),this.LevelUpCfg=Laya.loader.getRes("res/cfg/LevelUpCfg.json"),this.skinCfg=[{Icon:"head1",mode:"Head01_bear",gold:150},{Icon:"head2",mode:"Head02_cat",gold:150},{Icon:"head3",mode:"Head03_pig",gold:150},{Icon:"head4",mode:"Head04_rabbit",gold:250},{Icon:"head5",mode:"Head05_monkey",gold:250},{Icon:"head6",mode:"Head06_mouse",gold:250},{Icon:"head7",mode:"Head07_elephant",gold:250},{Icon:"head8",mode:"Head08_chicken",gold:250},{Icon:"head9",mode:"Head09_giraffe",gold:250},{Icon:"head10",mode:"Head10_leopard",gold:250},{Icon:"head11",mode:"Head11_horse",gold:250},{Icon:"head12",mode:"Head12_zebra",gold:250},{Icon:"head13",mode:"Head13_eagle",gold:250},{Icon:"head14",mode:"Head14_cow",gold:250},{Icon:"head15",mode:"Head15_egg",gold:250},{Icon:"head16",mode:"Head16_fish",gold:250},{Icon:"head17",mode:"Head17_panda",gold:250},{Icon:"head18",mode:"Head18_tiger",gold:250},{Icon:"head19",mode:"Head19_Octopus",gold:250},{Icon:"head20",mode:"Head20_mantis",gold:250},{Icon:"head21",mode:"Head21_skull",gold:250}],this.SwordCfg=[{Icon:"weapon1",mode:"sword01",gold:500},{Icon:"weapon2",mode:"sword02",gold:500},{Icon:"weapon3",mode:"sword03",gold:500},{Icon:"weapon4",mode:"sword04",gold:500},{Icon:"weapon5",mode:"sword05",gold:250},{Icon:"weapon6",mode:"sword06",gold:250},{Icon:"weapon7",mode:"sword07",gold:250},{Icon:"weapon8",mode:"sword08",gold:250},{Icon:"weapon9",mode:"sword09",gold:250},{Icon:"weapon10",mode:"sword10",gold:250},{Icon:"weapon11",mode:"sword11",gold:250},{Icon:"weapon12",mode:"sword12",gold:250}],this.ShieldCfg=[{Icon:"shield1",mode:"shield01",gold:250},{Icon:"shield2",mode:"shield02",gold:350},{Icon:"shield3",mode:"shield03",gold:350},{Icon:"shield4",mode:"shield04",gold:500},{Icon:"shield5",mode:"shield05",gold:250},{Icon:"shield6",mode:"shield06",gold:250},{Icon:"shield7",mode:"shield07",gold:250},{Icon:"shield8",mode:"shield08",gold:250}]}initData(e){var t=new Object;let i=Laya.loader.getRes(e);if(null==i)return console.error("兼容错误，找不到"+e+"表"),null;t.length=i.length;for(let e=0;e<i.length;e++)t[i[e].Id]=i[e];return t}initMapData(){this.mapCfg={},D.ResMgr.GetRes(h.Map).forEach(e=>{this.mapCfg[e.MapName]=e})}getLevelUpCfg(e){let t=0;for(let i=0;i<this.LevelUpCfg.length;i++){e>=this.LevelUpCfg[i].UpNum&&t++}return t=Math.min(t,this.LevelUpCfg.length-1),this.LevelUpCfg[t]}getSkinInfo(e){this.skinCfg[e]}getFightInfo(e){let t=this.fightCfg[e];return t||null}getAiInfo(e){let t=this.aiCfg[e];return t||null}getSkinData(e){let t=this.skinCfg[e];return t||null}getSpecialSkinList(){let e=new Array;for(let t=1;t<=this.skinCfg.length;t++)this.skinCfg[t].Type==d.Deadline&&e.push(this.skinCfg[t]);return e}getBadgeCfg(e){let t=this.badgeCfg[e];return t||null}getGlobalCfg(e){let t=this.globalCfg[e];return t||0}GetSkinConfig(e=null){return null==e?this.skinCfg:this.getSkinData(e)}GetMapConfig(e){return this.mapCfg[e]}GetItemConfig(e){return this.itemCfg[e]}GetSnakeExp(e){return this.expCfg[e]}GetFightConfig(e){return this.fightCfg[e]}CheckIsOwn(e,t){let i=t;if(0===i.length)return!1;for(let t=0;t<i.length;t++)if(i[t]===e)return!0;return!1}ChangeLockId(e,t,i){let a=e+1,n=null,s=0;switch(i){case 1:n=this.skinCfg,s=D.DataMgr.LockOwnSkin;break;case 2:n=this.SwordCfg,s=D.DataMgr.LockOwnSword;break;case 3:n=this.ShieldCfg,s=D.DataMgr.LockOwnShield}for(let e=a;e<n.length;e++)if(!this.CheckIsOwn(e,t)){switch(i){case 1:D.DataMgr.LockOwnSkin=e;break;case 2:D.DataMgr.LockOwnSword=e;break;case 3:D.DataMgr.LockOwnShield=e}return}}}class C{constructor(){this.s_setSound="s_setSound",this.isStoped=!1,this._isOpenVoice=!0;let e=window.localStorage.getItem(this.s_setSound);e&&(this._isOpenVoice="1"==e)}get isOpenVoice(){return this._isOpenVoice}set isOpenVoice(e){this._isOpenVoice=e,e?this.playBGM():this.stopBGM(),window.localStorage.setItem(this.s_setSound,e?"1":"0")}init(){Laya.SoundManager.autoStopMusic=!0}playBGM(){this.isOpenVoice&&(this.setMusicVolume(.5),this.channel=Laya.SoundManager.playMusic(u.Bgm))}stopBGM(){this.setMusicVolume(0)}playBtnClick(){D.CfgMgr.playMuisc&&this.isOpenVoice&&this.playSound("sound/hit.wav")}playBattleClick(){D.CfgMgr.playMuisc&&this.isOpenVoice&&(this.setSoundVolume(.1),this.playSound("sound/tou.mp3"))}playgiaogiao(){D.CfgMgr.playMuisc&&this.isOpenVoice&&(this.setSoundVolume(.5),this.playSound("sound/giaogiao.mp3"))}playliekaile(){D.CfgMgr.playMuisc&&this.isOpenVoice&&D.CfgMgr.muiceOpen&&(this.setSoundVolume(.1),this.playSound("sound/liekaile.mp3"))}playnihaohuai(){this.isOpenVoice&&D.CfgMgr.muiceOpen&&(this.setSoundVolume(.3),this.playSound("sound/nihaohuai.mp3"))}playwotainanle(){D.CfgMgr.playMuisc&&this.isOpenVoice&&D.CfgMgr.muiceOpen&&(this.setSoundVolume(.5),this.playSound("sound/wotainanle.mp3"))}playwocaowuqing(){D.CfgMgr.playMuisc&&this.isOpenVoice&&D.CfgMgr.muiceOpen&&(this.setSoundVolume(.5),this.playSound("sound/wocaowuqing.mp3"))}playSound(e){D.CfgMgr.playMuisc&&this.isOpenVoice&&Laya.SoundManager.playSound(e)}setSoundVolume(e){Laya.SoundManager.setSoundVolume(e)}setMusicVolume(e){Laya.SoundManager.setMusicVolume(e)}}class w{constructor(){this._data={},this.sharecard_config=[{shareid:335,imageurl:"https://zjjh-1256732840.cos.ap-guangzhou.myqcloud.com/share01.jpg",title:"嗨，哥们！快来拯救我们吧！"},{shareid:336,imageurl:"https://zjjh-1256732840.cos.ap-guangzhou.myqcloud.com/share02.jpg",title:"当你看到这条分享，是真的江湖急救！！不是向你借钱…"},{shareid:337,imageurl:"https://zjjh-1256732840.cos.ap-guangzhou.myqcloud.com/share03.jpg",title:"小时候的梦想是拯救世界！来吧，再给你一次机会。"}],this.initData()}init(){var e=Laya.LocalStorage.getJSON("dice1");for(const t in e)e.hasOwnProperty(t)&&(this._data[t]=e[t]);this.refreshSevenDay()}initData(){this._data={goldCount:0,bSound:!0,bVibration:!0,PowLevel:1,NumLevel:1,EatChickenTime:0,NewBee:!0,canGetDay:0,IsGetDay:0,LoginDay:0,OwnSkin:[0],OwnSword:[0],OwnShield:[0],LockOwnSkin:1,LockOwnSword:1,LockOwnShield:1,UseSkin:0,UseSword:-1,UseShield:-1,MaxScene:1,Level:1,isSameDay:!1,loginNum:0}}refreshSevenDay(){let e=(new Date).getDate();e!=this._data.LoginDay&&(this._data.LoginDay=e,this._data.canGetDay++,this._data.isSameDay=!1),this._data.canGetDay=Math.floor(this._data.canGetDay)}get goldCount(){return this._data.goldCount}addGoldCount(e){this._data.goldCount+=e,this.saveData()}get EatChickenTime(){return this._data.EatChickenTime}AddEatChickenTime(){this._data.EatChickenTime++,this.saveData()}get bVibration(){return this._data.bVibration}set bVibration(e){this._data.bVibration=e,this.saveData()}get NewBee(){return this._data.NewBee}set NewBee(e){this._data.NewBee=e,this.saveData()}get loginNum(){return this._data.loginNum}set loginNum(e){this._data.loginNum=e,this.saveData()}get isSameDay(){return this._data.isSameDay}addIsSameDay(e){this._data.isSameDay=e,this.saveData()}get PowLevel(){return this._data.PowLevel}set PowLevel(e){this._data.PowLevel=e,this.saveData()}get GetOwnSkin(){return this._data.OwnSkin}set SetOwnSkin(e){this._data.OwnSkin.push(e),this.saveData()}get GetOwnSword(){return this._data.OwnSword}set SetOwnSword(e){this._data.OwnSword.push(e),this.saveData()}get GetOwnShield(){return this._data.OwnShield}set SetOwnShield(e){this._data.OwnShield.push(e),this.saveData()}get LockOwnSkin(){return this._data.LockOwnSkin}set LockOwnSkin(e){this._data.LockOwnSkin=e,this.saveData()}get LockOwnSword(){return this._data.LockOwnSword}set LockOwnSword(e){this._data.LockOwnSword=e,this.saveData()}get LockOwnShield(){return this._data.LockOwnShield}set LockOwnShield(e){this._data.LockOwnShield=e,this.saveData()}get UseSkin(){return this._data.UseSkin}set UseSkin(e){this._data.UseSkin=e,this.saveData()}get UseSword(){return this._data.UseSword}set UseSword(e){this._data.UseSword=e,this.saveData()}get UseShield(){return this._data.UseShield}set UseShield(e){this._data.UseShield=e,this.saveData()}get MaxScene(){return this._data.MaxScene}set MaxScene(e){let t=Math.min(e,4);this._data.MaxScene=t,this.saveData()}get Level(){return this._data.Level}set Level(e){this._data.Level=e,this.saveData()}get NumLevel(){return this._data.NumLevel}set NumLevel(e){this._data.NumLevel=e,this.saveData()}get canGetDay(){return this._data.canGetDay}set canGetDay(e){this._data.canGetDay=e,this.saveData()}get IsGetDay(){return this._data.IsGetDay}set IsGetDay(e){this._data.IsGetDay=e,this.saveData()}saveData(){Laya.LocalStorage.setJSON("dice1",this._data)}cacheData(e){"_arrCarIds"==e||Laya.LocalStorage.setItem(e,this[e])}}let S={State:{Start:1,End:2},Scenes:{Desk:"Desk",City:"City",Fram:"Fram",Garden:"Garden",LivingRoom:"LivingRoom"}};class I{static isVector3(e){return"laya.d3.math.Vector3"==e.__className}static isVector2(e){return"laya.d3.math.Vector2"==e.__className}static isPoint(e){return"laya.d3.math.Point"==e.__className}static Clamp(e,t,i){return e>i?i:e<t?t:e}static DistanceV3(e,t){var i=e.transform.position.x-t.transform.position.x,a=e.transform.position.z-t.transform.position.z,n=e.Size+t.Size+5;return i*i+a*a<=n*n}static NewbeeDistanceV3(e,t){var i=e.transform.position.x-t.transform.position.x,a=e.transform.position.z-t.transform.position.z;return i*i+a*a<=6400}static DDistanceV3(e,t,i,a){var n=i.x-t.transform.position.x,s=i.z-t.transform.position.z,o=a.x-t.transform.position.x,l=a.z-t.transform.position.z,r=e.Size+t.Size;return!(n*n+s*s>o*o+l*l)&&n*n+s*s<=r*r}static Clamp01(e){return e<0?0:e>1?1:e}static Angle(e,t){return 57.29578*Math.acos(this.Clamp(this.Dot(this.Normalized(e),this.Normalized(t)),-1,1))}static Distance(e,t){var i=e.x-t.x,a=e.y-t.y,n=0;return this.isVector3(e)&&(n=e.z-t.z),Math.sqrt(Math.abs(i+a+n))}static Distance2(e,t){var i=e.x-t.x,a=e.y-t.y;return Math.sqrt(i*i+a*a)}static Rotation2D(e,t){var i,a=t.x-e.x,n=e.y-t.y;return 0==a?i=n<0?90:-90:(i=Math.atan(n/a)/Math.PI*180,a>0&&(i+=180),i)}static RotationTwo(e,t){var i,a=t.x-e.x,n=e.y-t.y;return 0==n?i=a>0?0:180:0==a?i=n>0?90:-90:(i=Math.atan(n/a)/Math.PI*180,a>0&&(i+=180),i)}static Add(e,t){return this.isVector3(e)?new Laya.Vector3(e.x+t.x,e.y+t.y,e.z+t.z):this.isVector2(e)?new Laya.Vector2(e.x+t.x,e.y+t.y):null}static Less(e,t){return this.isVector3(e)?new Laya.Vector3(e.x-t.x,e.y-t.y,e.z-t.z):this.isVector2(e)?new Laya.Vector2(e.x-t.x,e.y-t.y):null}static Multiply(e,t){return this.isVector3(e)?new Laya.Vector3(e.x*t,e.y*t,e.z*t):this.isVector2(e)?new Laya.Vector2(e.x*t,e.y*t):null}static Lerp(e,t,i){return i=this.Clamp01(i),this.isVector3(e)?new Laya.Vector3(e.x+(t.x-e.x)*i,e.y+(t.y-e.y)*i,e.z+(t.z-e.z)*i):this.isVector2(e)?new Laya.Vector2(e.x+(t.x-e.x)*i,e.y+(t.y-e.y)*i):null}static Divide(e,t){return this.isVector3(e)?new Laya.Vector3(e.x/t,e.y/t,e.z/t):this.isVector2(e)?new Laya.Vector2(e.x/t,e.y/t):void 0}static Normalized(e){var t=this.magnitude(e);return t>1e-5?e=this.Divide(e,t):(this.isVector3(e)&&(e=new Laya.Vector3(0,0,0)),this.isVector2(e)&&(e=new Laya.Vector2(0,0))),e}static magnitude(e){return Math.sqrt(this.sqrMagnitude(e))}static sqrMagnitude(e){var t=e.x*e.x+e.y*e.y;return this.isVector3(e)&&(t+=e.z*e.z),t}static clampMagnitude(e,t){return this.sqrMagnitude(e)>t*t?(e=this.Normalized(e),this.Multiply(e,t)):e}static random(e,t){Math.random();return Math.floor(e+Math.random()*(t-e))}static sortHandle(e,t){return e>t?1:-1}static isEmpty(e){return void 0===e||null==e||""==e}static Dot(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}static TransferStringToNumberArr(e){var t=[],i=e.split(",");for(let e=0;e<i.length;e++)t.push(parseFloat(i[e]));return t}static ScoreToString(e){var t=Math.ceil(e).toString();return 4==t.length?t=(t=t.substring(0,3)).substring(0,1)+"."+t.substring(2,3)+"k":5==t.length?t=(t=t.substring(0,3)).substring(0,2)+"."+t.substring(3,3)+"k":6==t.length?t=(t=t.substring(0,4)).substring(0,3)+"."+t.substring(4,4)+"k":7==t.length?t=(t=t.substring(0,4)).substring(0,1)+"."+t.substring(2,4)+"M":8==t.length&&(t=(t=t.substring(0,5)).substring(0,2)+"."+t.substring(3,5)+"M"),t}static getCurrentTime(){return Date.parse((new Date).toString())}static transferSecondToHMS(e){var t=new Date(e);return t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}static Intersection(e,t,i,a){let n=t.x-e.x,s=i.x-a.x,o=t.y-e.y,l=i.y-a.y,r=i.x-e.x,h=i.y-e.y,d=n*l-s*o;if(Math.abs(d)<1e-6)return!1;let g=(l*r-s*h)/d,c=(-o*r+n*h)/d;return!(0>g||g>1)&&!(0>c||c>1)}}class v{constructor(){this.state=S.State.End,this.trySkinId=0,this.biggerNum=0,this._deltaTime=0,this._playerArr=[]}setRandomSkin(){var e=I.TransferStringToNumberArr(D.CfgMgr.getGlobalCfg("SkinTryList"));this.trySkinId=e[I.random(0,e.length-1)]}timer(){if(this._deltaTime+=1/60,this._deltaTime>=1){this._deltaTime=0,this.roundTime--,this.roundTime<=0&&this.roundEnd();var e=this.roundReadTime[this._readCount];null!=e&&this.roundTime==e&&(this._readCount++,D.EventMgr.event(r.Battle_AlertInfo,[this._playerArr[this._playerArr.length-1],e,this._readCount==this.roundReadTime.length]))}}StartGame(){this.roundCount=0}StopGame(){console.log("闯关失败"),this._playerArr.length=0}roundStart(){this.roundCount++;var e=this.roundCount,t=D.CfgMgr.fightCfg.length-1;e>t&&(e=I.random(1,t));var i=D.CfgMgr.GetFightConfig(e);this.rountTotalTime=i.Time,this.roundTime=this.rountTotalTime,this.roundReadTime=I.TransferStringToNumberArr(i.ReadTime),this._readCount=0,console.log("开始第",this.roundCount,"轮",this.rountTotalTime,"秒"),D.EventMgr.event(r.Battle_AddScore,[this._playerArr]),this.state=S.State.Start,Laya.timer.frameLoop(1,this,this.timer)}roundEnd(){Laya.timer.clear(this,this.timer),this.state=S.State.End,console.log("一轮结束:",this.roundCount);if(this._playerArr.length>1){var e=this._playerArr.pop();e.score,e.playerId}}}class B{static findHitResult(){var e=new Laya.Ray(new Laya.Vector3(0,0,0),new Laya.Vector3(0,0,0)),t=new Laya.Vector2;let i=new Laya.HitResult,a=D.SceneMgr.Maincamera;return t.x=Laya.stage.mouseX,t.y=Laya.stage.mouseY,a.viewportPointToRay(t,e),D.SceneMgr.scene.physicsSimulation.rayCast(e,i),i}}class M extends Laya.Script{constructor(){super()}onAwake(){this.gameObject=this.owner,this.transform=this.gameObject.transform}updateLogic(e){}crossFade(e,t){this.animator&&this.animator.crossFade(e,t)}setData(e){this.cfgData=e}}class L extends M{constructor(){super(),this.TimeCount=0}onAwake(){super.onAwake(),this.m_pos=this.transform.position}initData(e){this.startBuild=e.start,this.endBuild=e.end,this.camp=e.camp;let t=new Laya.Vector2,i=new Laya.Vector2;t.x=this.startBuild.transform.localPositionX,t.y=this.startBuild.transform.localPositionZ,i.x=this.endBuild.transform.localPositionX,i.y=this.endBuild.transform.localPositionZ;let a=I.Distance2(t,i),n=I.Rotation2D(t,i),s=I.RotationTwo(t,i),o=Math.floor(2*a);this.ID=e.id,this.LineCnt=o,this.ShowLineCnt=o;let l=(this.endBuild.transform.localPositionX+this.startBuild.transform.localPositionX)/2,r=(this.endBuild.transform.localPositionZ+this.startBuild.transform.localPositionZ)/2;this.gameObject.transform.localPositionX=l,this.gameObject.transform.localPositionZ=r;let h=D.SceneMgr.chooseMesh(this.camp,3);for(let e=0;e<o;e++){let t=new Laya.MeshSprite3D,i=new Laya.Sprite3D;(t=D.SceneMgr.LineTest).transform.localRotationEulerY=n+90,Laya.Sprite3D.instantiate(t,i);let a=.45*(e-o/2)*Math.round(1e4*Math.cos(s*Math.PI/180)/1e3)/10,l=.45*(e-o/2)*Math.round(1e4*Math.sin(s*Math.PI/180)/1e3)/10;this.gameObject.addChild(i),i.getChildAt(0).meshRenderer.material=h,i.transform.localPosition=new Laya.Vector3(-a,.2,l)}this.Index=1}update(){if(this.TimeCount++,this.TimeCount%4==0){this.Index--;let e=this.Index%10/10-.5;if(0===this.gameObject.numChildren)return;for(let t=0;t<this.gameObject.numChildren;t++){this.gameObject.getChildAt(t).getChildAt(0).meshRenderer.material.tilingOffset=new Laya.Vector4(1,1,0,e)}}}changeLineCnt(){let e=new Laya.Vector2,t=new Laya.Vector2;e.x=this.startBuild.transform.localPositionX,e.y=this.startBuild.transform.localPositionZ,t.x=this.endBuild.transform.localPositionX,t.y=this.endBuild.transform.localPositionZ;let i=I.Rotation2D(e,t);I.RotationTwo(e,t);this.ShowLineCnt=this.LineCnt/2;for(let e=0;e<this.LineCnt;e++)i%90==0?e<this.ShowLineCnt&&(this.gameObject.getChildAt(e).transform.localScale=new Laya.Vector3(0,0,0)):e>=this.ShowLineCnt&&(this.gameObject.getChildAt(e).transform.localScale=new Laya.Vector3(0,0,0))}changeLineCnt2(){this.ShowLineCnt=this.LineCnt/2;for(let e=0;e<this.LineCnt;e++)this.gameObject.getChildAt(e).transform.localScale=new Laya.Vector3(1,1,1)}}class k{constructor(){this.camp=0,this.initTarget=null}static FindTaget(e){if(1===e.getComponent(A).camp||6===e.getComponent(A).camp||D.SceneMgr.isIce)return;D.SceneMgr.Maincamera;let t=new Laya.HitResult,i=D.SceneMgr.AllBuilding,a=new Laya.Vector3,n=e.getComponent(A).TargetBuild,s=[],o=new Laya.Sprite3D;if(0===i.length)return null;for(let o=0;o<i.length;o++){let l=i[o].getComponent(A);if(e.getComponent(A).ID!==l.ID&&(a=i[o].transform.localPosition,D.SceneMgr.scene.physicsSimulation.raycastFromTo(e.transform.localPosition,a,t),t.succeeded&&"build"===t.collider.owner.name))if(0!=n.length)for(let e=0;e<n.length;e++){let i=n[e];if(t.collider.owner!=i){s.push(t.collider.owner);break}}else s.push(t.collider.owner)}if(0===s.length)return null;for(let t=0;t<s.length;t++){let i=s[t].transform.localPositionX-e.transform.localPositionX,a=s[t].transform.localPositionZ-e.transform.localPositionZ;Math.sqrt(i*i+a*a);if(s[t].getComponent(A).checkAINeedCreatLine(e)){o=s[t];break}}this.CreatBulindLine(e,o)}static FindLockTaget(e,t){if(1===e.getComponent(A).camp||6===e.getComponent(A).camp||D.SceneMgr.isIce)return;if(e.getComponent(A).ID===t)return;new Laya.HitResult;let i=D.SceneMgr.AllBuilding,a=new Laya.Sprite3D;if(0===i.length)return null;for(let n=0;n<i.length;n++){if(i[n].getComponent(A).ID==t)return a=i[n],void this.CreatBulindLine(e,a)}}static CreatBulindLine(e,t){let i=e.getComponent(A);if(!i.checkCanCreatLine(t))return;let a=new Laya.HitResult;if(D.SceneMgr.scene.physicsSimulation.raycastFromTo(e.transform.localPosition,e.transform.localPosition,a),a.succeeded&&"collider"===a.collider.owner.name)return;let n=new Laya.Vector2,s=new Laya.Vector2;n.x=e.transform.localPositionX,n.y=e.transform.localPositionZ,s.x=t.transform.localPositionX,s.y=t.transform.localPositionX;let o=I.Distance2(n,s),l=I.Rotation2D(n,s),r=new Laya.Sprite3D;D.SceneMgr.scene.addChild(r);let h=r.addComponent(L),d={start:e,end:t,length:o,rot:l,id:-1,camp:i.camp};h.initData(d),i.changeTarget(t,r),i.LineS.push(r)}}class b extends M{constructor(){super(),this.isDead=!1,this.startPoint=new Laya.Vector2,this.endPoint=new Laya.Vector2,this.isadd=!1}onAwake(){super.onAwake(),this.m_pos=this.transform.position}initData(e,t){D.SceneMgr.SoliderNum++;let i=t.obj;this.OwnBuild=t,this.startBuild=e;let a=e.getComponent(A);this.endBuild=i,this.camp=a.camp,this.startPoint.x=this.startBuild.transform.localPositionX,this.startPoint.y=this.startBuild.transform.localPositionZ,this.endPoint.x=this.endBuild.transform.localPositionX,this.endPoint.y=this.endBuild.transform.localPositionZ,this.dis=I.Distance2(this.startPoint,this.endPoint),this.rotation=I.RotationTwo(this.startPoint,this.endPoint);let n=this.gameObject.getChildAt(0).getChildAt(1),s=D.SceneMgr.chooseMesh(this.camp,1);n.skinnedMeshRenderer.material=s,this.rotation%90==0?this.rotation+=90:this.rotation-=90,this.gameObject.transform.localRotationEulerY=this.rotation,this.transform.localPosition=this.startBuild.transform.localPosition,this.transform.localPositionX=this.startBuild.transform.localPositionX+1.2*Math.round(1e4*Math.sin(this.rotation*Math.PI/180)/1e3)/10,this.transform.localPositionZ=this.startBuild.transform.localPositionZ+1.2*Math.round(1e4*Math.cos(this.rotation*Math.PI/180)/1e3)/10;let o=this.gameObject.getChildAt(0).getComponent(Laya.Animator);o.play("move"),o.speed=2;let l=a.type;if(1===this.camp)this.ShowRole(l,null);else{let e=D.SceneMgr.AllCampData[this.camp-2];this.ShowRole(l,e)}1===l?(this.Hp=1,this.Attack=1,this.AttackBuild=1):2===l?(this.Hp=2,this.Attack=2,this.AttackBuild=2):(this.Hp=2,this.Attack=2,this.AttackBuild=1),this.m_pos=this.transform.position}update(){if(!this.gameObject.active||this.isDead)return;let e=Laya.timer.delta/1e3*60,t=this.m_pos;this.checkEatSolider(t),this.checkEatBuild(t),t.x+=.05*Math.round(1e4*Math.sin(this.rotation*Math.PI/180)/1e3)/10*e,t.z+=.05*Math.round(1e4*Math.cos(this.rotation*Math.PI/180)/1e3)/10*e,this.m_pos=t,this.transform.position=this.m_pos}checkEatSolider(e){let t=this.endBuild.getComponent(A);if(t.camp===this.camp)return;if(0==t.SolideS.length)return;let i=null;for(let e=0;e<t.TargetBuild.length;e++){let a=t.TargetBuild[e];a.obj===this.startBuild&&(i=a)}if(null!=i){if(0==i.solider.length)return;for(let t=0;t<i.solider.length;t++){let a=i.solider[t],n=a.getComponent(b),s=a.transform.localPositionX-e.x,o=a.transform.localPositionZ-e.z;Math.sqrt(s*s+o*o)<2&&this.gameObject.active&&a.active&&!this.isDead&&!n.isDead&&this.Damage(n)}}}Damage(e){let t=this.gameObject.getChildAt(0).getComponent(Laya.Animator),i=e.gameObject.getChildAt(0).getComponent(Laya.Animator);this.Hp-=e.Attack,e.Hp-=this.Attack,this.Hp<=0&&(this.OwnBuild.soliderLive++,this.isDead=!0,D.SceneMgr.SoliderNum--,t.play("die"),Laya.timer.once(1e3,this,()=>{this.gameObject.active=!1})),e.Hp<=0&&(e.OwnBuild.soliderLive++,D.SceneMgr.SoliderNum--,e.isDead=!0,i.play("die"),Laya.timer.once(1e3,this,()=>{e.gameObject.active=!1}))}checkEatBuild(e){let t=this.endBuild.transform,i=this.AttackBuild,a=this.endBuild.getComponent(A),n=t.localPositionX-e.x,s=t.localPositionZ-e.z;(this.camp!=a.camp||this.isadd)&&(i=-this.AttackBuild),i=Math.min(1,i),Math.abs(n)<2&&Math.abs(s)<2&&this.gameObject.active&&(1===this.camp&&D.SoundMgr.playSound("sound/eatBuild.mp3"),D.SceneMgr.SoliderNum--,this.OwnBuild.soliderLive++,this.camp===a.camp&&3===this.startBuild.getComponent(A).type&&(i=2),a.refreshBuild(i,this.camp),this.gameObject.active=!1)}ShowRole(e,t){let i=D.DataMgr.UseSword,a=D.DataMgr.UseShield,n=D.DataMgr.UseSkin;null!=t&&(i=t.UseSword,a=t.UseShield,n=t.UseSkin);let s=this.gameObject.getChildAt(0).getChildByName("BoneBip01").getChildByName("BoneBip02"),o=s.getChildByName("BoneHead").getChildAt(0),l=s.getChildByName("BoneLHand01").getChildByName("BoneLHand02").getChildByName("BoneLHand03").getChildAt(0),r=s.getChildByName("BoneRHand01").getChildByName("BoneRHand02").getChildByName("BoneRHand03").getChildAt(0);-1==i?l.active=!1:(l.active=!0,l.meshFilter.sharedMesh=D.SceneMgr.AllWeapon[i].meshFilter.sharedMesh,l.meshRenderer.material=D.SceneMgr.AllWeapon[i].meshRenderer.material),-1==a?r.active=!1:(r.active=!0,r.meshFilter.sharedMesh=D.SceneMgr.AllShield[a].meshFilter.sharedMesh,r.meshRenderer.material=D.SceneMgr.AllShield[a].meshRenderer.material),o.meshFilter.sharedMesh=D.SceneMgr.AllHead[n].meshFilter.sharedMesh,o.meshRenderer.material=D.SceneMgr.AllHead[n].meshRenderer.material,1==e?(l.active=!1,r.active=!1):2==e?(l.active=!0,r.active=!1):(l.active=!1,r.active=!0)}}class A extends M{constructor(){super(),this.isPlayer=!1,this.MaxLevel=65,this.m_pos=new Laya.Vector3,this.MaxLines=1,this.LockLevel=0,this.TargetBuild=[],this.SolideS=[],this.LineS=[],this.InitAttaclTime=180,this.IsInitAttacl=!1,this.AttaclID=0,this.AttaclTimePer=180,this.higher=.5,this.type=0,this.SoliderSpeed=0,this.SoliderAliveNum=0,this.AddSoliderper=0,this.AddSolideTimeCount=0,this.StartTimeCount=0,this.TimeCount=0,this.SoliderCount=0,this.iaa=1,this.ID=0,this.camp=0,this.Level=0,this.LimitCreatSoliderTime=30}onAwake(){super.onAwake(),this.m_pos=this.transform.position}initBuild(e,t){this.gameObject.name="build";let i,a=D.SceneMgr.newLevel;i=D.DataMgr.NewBee?D.CfgMgr.CityLevelCfg[51]["build"+t][0]:D.CfgMgr.CityLevelCfg[""+a]["build"+t][0],this.camp=i.camp,this.ID=t,this.Levelcfg=i,this.transform.position=e,this.Level=i.level,this.AttaclID=i.target,this.AddSoliderper=60*D.CfgMgr.getLevelUpCfg(this.Level).recover,1===this.camp&&D.DataMgr.Level<=10&&4!=D.DataMgr.Level&&(D.DataMgr.Level<=5?this.AddSoliderper=Math.floor(this.AddSoliderper/2):this.AddSoliderper=Math.floor(this.AddSoliderper/1.5));let n=1;i.MaxLevel&&(this.MaxLevel=i.MaxLevel),1===i.type?(this.ChildBody=D.SceneMgr.NormalBuild,this.UIMsh=D.SceneMgr.TypeMeshNormal):2===i.type?(this.ChildBody=D.SceneMgr.AttackBulid,this.UIMsh=D.SceneMgr.TypeMeshAttack):(this.ChildBody=D.SceneMgr.DefenseBuild,this.UIMsh=D.SceneMgr.TypeMeshDefense),this.InitAttaclTime=i.start,this.AttaclTimePer=60*(Math.floor(12*Math.random())+3),this.type=i.type;let s=D.CfgMgr.getLevelUpCfg(this.MaxLevel).level+2,o=D.SceneMgr.chooseMesh(this.camp,1);for(let t=0;t<s;t++){let i=new Laya.MeshSprite3D;new Laya.Sprite3D;n=1.5*t,0===t?(i=this.ChildBody.getChildAt(0),n=0):1===t?i=this.ChildBody.getChildAt(2):(i=this.ChildBody.getChildAt(1),n=this.higher*(t-1)),i.active=!1,i.meshRenderer.sharedMaterial=o,i.transform.localPosition=new Laya.Vector3(e.x,n,e.z),Laya.Sprite3D.instantiate(i,this.gameObject)}this.creatBuildUI(),this.LockLevel=D.CfgMgr.getLevelUpCfg(this.Level).level;let l=this.LockLevel+2;for(let e=0;e<l;e++){let t=this.gameObject.getChildAt(e);t.active=!0,1===e&&(t.transform.localPositionY=(l-2)*this.higher+.45)}this.AddCollider(),this.setSoliderSpeed()}AddCollider(){let e=this.gameObject.addComponent(Laya.Rigidbody3D),t=new Laya.BoxColliderShape(3,this.LockLevel*this.higher+1.6,3);e.colliderShape=t,e.mass=10,e.linearFactor=new Laya.Vector3(0,0,0)}creatBuildUI(){let e=this.UIMsh;for(let t=0;t<3;t++){let t=new Laya.MeshSprite3D,i=new Laya.MeshSprite3D,a=new Laya.Sprite3D;t=D.SceneMgr.NumMesh,i=e,Laya.Sprite3D.instantiate(t,a),Laya.Sprite3D.instantiate(i,a),this.gameObject.getChildAt(1).addChild(a)}this.setMaxLines()}RefrshBuildUI(){let e=this.Level;e=Math.max(e,0);let t=this.gameObject.getChildAt(1),i=e%10,a=Math.floor(e/10)%10,n=Math.floor(e/100),s=4;2==this.type?s=6:3==this.type&&(s=5);let o=D.SceneMgr.chooseMesh(this.camp,s),l=D.SceneMgr.chooseMesh(6,s-2);for(let e=0;e<3;e++)e>this.MaxLines-1?t.getChildAt(e).getChildAt(1).active=!1:t.getChildAt(e).getChildAt(1).active=!0,t.getChildAt(e).transform.localPositionY=.5,t.getChildAt(e).getChildAt(1).transform.localScale=new Laya.Vector3(1.2,1.2,1.2),t.getChildAt(e).getChildAt(0).transform.localRotationEulerY=180,t.getChildAt(e).getChildAt(0).transform.localPositionZ=.3,t.getChildAt(e).getChildAt(1).transform.localPositionZ=-.5,e<this.TargetBuild.length?t.getChildAt(e).getChildAt(1).meshRenderer.material=o:t.getChildAt(e).getChildAt(1).meshRenderer.material=l;1===this.MaxLines?t.getChildAt(0).getChildAt(1).transform.localPositionX=0:2===this.MaxLines?(t.getChildAt(0).getChildAt(1).transform.localPositionX=.35,t.getChildAt(1).getChildAt(1).transform.localPositionX=-.35):(t.getChildAt(0).getChildAt(1).transform.localPositionX=.5,t.getChildAt(1).getChildAt(1).transform.localPositionX=0,t.getChildAt(2).getChildAt(1).transform.localPositionX=-.5),t.getChildAt(0).getChildAt(0).transform.localScale=new Laya.Vector3(1.75,1.75,1.75),e<10?(t.getChildAt(0).getChildAt(0).transform.localPositionX=0,t.getChildAt(0).getChildAt(0).meshRenderer.material=D.SceneMgr.NumMaterials[i],t.getChildAt(0).getChildAt(0).active=!0,t.getChildAt(1).getChildAt(0).active=!1,t.getChildAt(2).getChildAt(0).active=!1):e<100?e>=64?(t.getChildAt(0).getChildAt(0).meshRenderer.material=D.SceneMgr.NumMaterials[10],t.getChildAt(0).getChildAt(0).transform.localPositionX=0,t.getChildAt(0).getChildAt(0).transform.localScale=new Laya.Vector3(4,1.75,4),t.getChildAt(0).getChildAt(0).active=!0,t.getChildAt(1).getChildAt(0).active=!1,t.getChildAt(2).getChildAt(0).active=!1):(t.getChildAt(0).getChildAt(0).transform.localPositionX=.3,t.getChildAt(1).getChildAt(0).transform.localPositionX=-.3,t.getChildAt(0).getChildAt(0).meshRenderer.material=D.SceneMgr.NumMaterials[a],t.getChildAt(1).getChildAt(0).meshRenderer.material=D.SceneMgr.NumMaterials[i],t.getChildAt(0).getChildAt(0).active=!0,t.getChildAt(1).getChildAt(0).active=!0,t.getChildAt(2).getChildAt(0).active=!1):(t.getChildAt(0).getChildAt(0).transform.localPositionX=.55,t.getChildAt(1).getChildAt(0).transform.localPositionX=0,t.getChildAt(2).getChildAt(0).transform.localPositionX=-.55,t.getChildAt(0).getChildAt(0).meshRenderer.material=D.SceneMgr.NumMaterials[n],t.getChildAt(1).getChildAt(0).meshRenderer.material=D.SceneMgr.NumMaterials[a],t.getChildAt(2).getChildAt(0).meshRenderer.material=D.SceneMgr.NumMaterials[i],t.getChildAt(0).getChildAt(0).active=!0,t.getChildAt(1).getChildAt(0).active=!0,t.getChildAt(2).getChildAt(0).active=!0)}setMaxLines(){this.Level;this.Level<10?this.MaxLines=1:this.Level<30?this.MaxLines=2:this.MaxLines=3,this.RefrshBuildUI()}setSoliderSpeed(){let e=D.CfgMgr.getLevelUpCfg(this.Level),t=this.TargetBuild.length;0!==t&&(this.SoliderSpeed=1===t?60*e.fire1:2===t?60*e.fire2:60*e.fire3,1===this.camp&&D.DataMgr.Level<=10&&4!=D.DataMgr.Level&&(D.DataMgr.Level<=5?this.SoliderSpeed=Math.floor(this.SoliderSpeed/2):this.SoliderSpeed=Math.floor(this.SoliderSpeed/1.5),D.SceneMgr.isDb&&(this.SoliderSpeed=Math.floor(this.SoliderSpeed/2))))}changeCamp(e){1===e&&(o.vibrateShort(),this.iceEff&&this.iceEff.parent&&(D.SceneMgr.scene.removeChild(this.iceEff),this.iceEff.destroy()),D.SoundMgr.playSound("sound/own.mp3")),this.camp=e,this.SolideS=[],this.setSoliderSpeed(),this.RefrshBuildUI();let t=D.CfgMgr.getLevelUpCfg(this.MaxLevel).level+2,i=D.SceneMgr.chooseMesh(this.camp,1);this.showChangeCampEffect();for(let e=0;e<t;e++){this.gameObject.getChildAt(e).meshRenderer.sharedMaterial=i}if(0!=this.TargetBuild.length)for(let e=0;e<this.TargetBuild.length;e++){let t=this.TargetBuild[e].obj;this.ClearTarget(t)}if(this.TargetBuild=[],0!=this.LineS.length){for(let e=0;e<this.LineS.length;e++)D.SceneMgr.scene.removeChild(this.LineS[e]),this.LineS[e].destory;this.LineS=[]}}showChangeCampEffect(){let e=new Laya.Sprite3D,t=new Laya.Sprite3D,i=D.SceneMgr.chooseShuriKenParticle3D(this.camp);Laya.Sprite3D.instantiate(i,t),e.addChild(t),D.SceneMgr.scene.addChild(e),e.getChildAt(0).getChildAt(0).getComponent(Laya.Animator).play("Great"),e.getChildAt(0).transform.localPosition=this.gameObject.transform.localPosition,e.getChildAt(0).transform.localPositionY=2,Laya.timer.frameOnce(35,this,()=>{D.SceneMgr.scene.removeChild(e),e.destroy()})}showIceEffect(){let e=D.CfgMgr.getLevelUpCfg(this.Level).level*this.higher+1.6;if(this.iceEff)this.iceEff.active=!0,Laya.timer.once(3e4,this,()=>{this.iceEff.active=!1});else{let t=new Laya.Sprite3D,i=D.SceneMgr.IceEff.clone();t.addChild(i),this.iceEff=t,D.SceneMgr.AllEffect.push(t),D.SceneMgr.scene.addChild(t),t.transform.localPosition=this.gameObject.transform.localPosition,t.transform.localScaleY=e/3-.4,Laya.timer.once(3e4,this,()=>{t.active=!1})}}showBuildDestoyEffect(e){D.CfgMgr.getLevelUpCfg(this.Level).level;let t=new Laya.Sprite3D,i=D.SceneMgr.BuildLevelUpEffect;Laya.Sprite3D.instantiate(i,t),D.SceneMgr.scene.addChild(t);let a=D.SceneMgr.chooseMesh(this.camp,1);for(let e=0;e<t.getChildAt(0).numChildren;e++)t.getChildAt(0).getChildAt(e).meshRenderer.material=a;t.getChildAt(0).transform.localPosition=this.gameObject.transform.localPosition,t.getChildAt(0).transform.localPositionY=e,Laya.timer.frameOnce(67,this,()=>{D.SceneMgr.scene.removeChild(t),t.destroy()})}showBuildChangeEffect(e,t,i){let a=this.gameObject.getChildAt(1);if(t>this.gameObject.numChildren-1)return;let n=this.gameObject.getChildAt(t);a.transform.localScale=new Laya.Vector3(.9,.9,.9),Laya.Tween.to(a.transform,{localScaleX:1,localScaleY:1,localScaleZ:1,localPositionY:e},100,null,Laya.Handler.create(this,function(e){n.active=i}))}refreshBuild(e,t){if(6==t)return;if(this.Level+=e,this.Level=Math.min(this.Level,65),this.Level>=65&&0!=this.TargetBuild.length&&this.LimitCreatSoliderTime<=0){this.SoliderCount++,this.LimitCreatSoliderTime=30;let e=this.SoliderCount%this.TargetBuild.length;this.TargetBuild[e].obj;this.CreatSolider(e)}this.setMaxLines(),this.Level<0&&(this.Level=0,this.changeCamp(t));let i=D.CfgMgr.getLevelUpCfg(this.Level).level;if(i===this.LockLevel)return;let a=i+2,n=0,s=0,o=!1;this.gameObject.getChildAt(1);i>this.LockLevel?(n=this.higher*i+.45,s=a-1,o=!0):(s=this.LockLevel+1,n=this.higher*i+.45,this.showBuildDestoyEffect(n)),this.showBuildChangeEffect(n,s,o),this.TimeCount=0,this.LockLevel=i;let l=i*this.higher+1.6;this.iceEff&&this.iceEff.parent&&(this.iceEff.transform.localScaleY=l/3-.4),this.gameObject.getComponent(Laya.Rigidbody3D).colliderShape=new Laya.BoxColliderShape(3,l,3),this.setSoliderSpeed()}update(){let e=Laya.timer.delta/1e3*60;this.TimeCount+=e,this.StartTimeCount+=e,this.LimitCreatSoliderTime>0&&(this.LimitCreatSoliderTime-=e);let t=this.TargetBuild.length;if(this.IsInitAttacl?this.StartTimeCount>this.AttaclTimePer&&(this.StartTimeCount=0,this.AttaclTimePer=60*(Math.floor(12*Math.random())+3),k.FindTaget(this.gameObject)):this.StartTimeCount>this.InitAttaclTime&&(this.IsInitAttacl=!0,this.StartTimeCount=0,this.AttaclID<50?k.FindLockTaget(this.gameObject,this.AttaclID):k.FindTaget(this.gameObject)),0!=t){if(1!=this.camp&&D.SceneMgr.isIce)return;if(this.AddSolideTimeCount=0,this.TimeCount>this.SoliderSpeed){this.SoliderCount++,this.TimeCount=0;let e=Math.floor(this.SoliderCount%t);this.TargetBuild[e].obj;this.CreatSolider(e)}}else{this.AddSolideTimeCount+=e;let t=1;if(this.AddSolideTimeCount>this.AddSoliderper){if(D.SceneMgr.isIce&&1!=this.camp)return;this.AddSolideTimeCount=0,1===this.camp&&D.SceneMgr.isDb&&(t=2),this.refreshBuild(t,this.camp)}}}CreatSolider(e){if(D.SceneMgr.SoliderNum>50)return;let t=this.TargetBuild[e];if(t.solider.length-t.soliderLive>10)return;t.obj,t.solider;let i=D.SceneMgr.Bear,a=new Laya.Sprite3D,n=(new Laya.Sprite3D,new Laya.Sprite3D);a=i,Laya.Sprite3D.instantiate(a,n),D.SceneMgr.scene.addChild(n);let s=n.addComponent(b);this.TargetBuild[e].solider.push(n),s.initData(this.gameObject,t),n.transform.localPosition=this.m_pos,n.transform.localRotationEulerX=-90,this.SolideS.push(n),D.SceneMgr.AllSoliders.push(n)}changeTarget(e,t){let i=e.getComponent(A);if(this.TimeCount=0,!(this.MaxLines<=this.TargetBuild.length)){if(0===this.TargetBuild.length){let a={obj:e,line:t,solider:[],soliderLive:0};return this.TargetBuild.push(a),this.LineS.push(t),D.SceneMgr.AllBuildingLine.push(t),i.camp!=this.camp&&this.changeLineCnt(a),this.RefrshBuildUI(),void this.setSoliderSpeed()}for(let a=0;a<this.TargetBuild.length;a++){let n=this.TargetBuild[a].obj.getComponent(A).ID;if(i.ID===n)return;{let a={obj:e,line:t,solider:[],soliderLive:0};return this.TargetBuild.push(a),this.LineS.push(t),D.SceneMgr.AllBuildingLine.push(t),i.camp!=this.camp&&this.changeLineCnt(a),this.RefrshBuildUI(),void this.setSoliderSpeed()}}}}ClearTarget(e){let t=e.getComponent(A),i=null,a=0;for(let e=this.TargetBuild.length-1;e>=0;e--){let n=this.TargetBuild[e].obj.getComponent(A).ID;t.ID===n&&(i=this.TargetBuild[e],a=e)}null!=i&&(t.checkLineMove(this.gameObject),this.TargetBuild.splice(a,1),this.LineS[a].active=!1,this.LineS.splice(a,1),this.RefrshBuildUI(),this.setSoliderSpeed())}checkLineMove(e){for(let t=0;t<this.TargetBuild.length;t++){let i=this.TargetBuild[t];if(i.obj==e){i.line.getComponent(L).changeLineCnt2()}}}checkCanCreatLine(e){let t=e.getComponent(A);if(null==t)return!1;if(0===this.TargetBuild.length)return!0;for(let e=0;e<this.TargetBuild.length;e++){let i=this.TargetBuild[e].obj.getComponent(A).ID;if(t.ID===i)return!1}return this.TargetBuild.length<this.MaxLines}checkNeedCreatLine(e,t){let i=e.getComponent(A);if(0!==this.TargetBuild.length)for(let t=0;t<this.TargetBuild.length;t++){this.TargetBuild[t].obj.getComponent(A).ID;if(this.TargetBuild[t].obj===e&&i.camp===this.camp)return void this.ClearTarget(e)}}checkAINeedCreatLine(e){if(e.getComponent(A).camp!=this.camp)return!0;if(0===this.TargetBuild.length)return!0;for(let t=0;t<this.TargetBuild.length;t++){this.TargetBuild[t].obj.getComponent(A).ID;if(this.TargetBuild[t].obj===e)return!1}return!0}changeLineCnt(e){let t=e.obj,i=e.line,a=t.getComponent(A);if(0!==a.TargetBuild.length)for(let e=0;e<a.TargetBuild.length;e++)a.TargetBuild[e].obj===this.gameObject&&(i.getComponent(L).changeLineCnt(),a.TargetBuild[e].line.getComponent(L).changeLineCnt())}clear(){this.TargetBuild=[],this.SolideS=[],this.LineS=[]}}class x{constructor(){this.firstClick=!0,this._stageMaterial={},this._stageMesh={},this.GayMaterial=null,this.YellowMaterial=null,this.GreenMaterial=null,this.RedMaterial=null,this.BuleMaterial=null,this.Camp1Materials=[],this.Camp2Materials=[],this.Camp3Materials=[],this.Camp4Materials=[],this.Camp5Materials=[],this.Camp6Materials=[],this.AllSecens=[],this.AllCollider=[],this.NumMaterials=[],this.NumMesh=null,this.TypeMeshNormal=null,this.TypeMeshAttack=null,this.TypeMeshDefense=null,this.NormalBuild=null,this.AttackBulid=null,this.DefenseBuild=null,this.ChooseBgChild=new Laya.MeshSprite3D,this.BulidLineChild1=new Laya.Sprite3D,this.BulidLineChild2=new Laya.Sprite3D,this.AllBuilding=[],this.AllEffect=[],this.AllHead=[],this.AllWeapon=[],this.AllShield=[],this.newLevel=0,this.AllCampData=[],this.Bear=new Laya.Sprite3D,this.AllBuildingLine=[],this.ChooseBg=new Laya.Sprite3D,this.AllSprite3D=[],this.AllSoliders=[],this.SoliderNum=0,this.IceEff=null,this.SnowEff=null,this.MainBuildLine=[],this.ChooseBg2=new Laya.Sprite3D,this.LineTest=new Laya.MeshSprite3D,this.ChooseBox=null,this.MainRole=new Laya.Sprite3D,this.startPoint=new Laya.Vector2(0,0),this.endPoint=new Laya.Vector2(0,0),this.clearStartPoint=new Laya.Vector2(0,0),this.clearEndPoint=new Laya.Vector2(0,0),this.BuildIngLineIndex=0,this.Coillder=new Laya.MeshSprite3D,this.isShowInt=!1,this.isDb=!1,this.isIce=!1}Initialization(){let e=this,t="game/other/Conventional/other.ls";"undefined"!=typeof wx&&(t="game/other/Conventional/other.ls"),Laya.Scene3D.load(t,Laya.Handler.create(null,function(t){e.initMatial(t),e.initMesh(t),e.initBuilding(t),e.initNumAndType(t),e.ChooseLine=t.getChildByName("UI").getChildByName("UI_Slide").getChildByName("UI_Plane"),e.ChooseBgChild=t.getChildByName("UI").getChildByName("UI_Slide").getChildByName("UI_Circ"),e.BulidLineChild1=t.getChildByName("Line").getChildByName("LineA"),e.BulidLineChild2=t.getChildByName("Line").getChildByName("LineB"),e.LineTest=t.getChildByName("UI").getChildByName("Line"),e.Bear=t.getChildByName("Player").getChildByName("PlayerBody"),e.Bear.transform.localRotationEulerX=90,e.changeCampEffectBule=t.getChildByName("FX").getChildByName("Great2_blue"),e.changeCampEffectGreen=t.getChildByName("FX").getChildByName("Great2_green"),e.changeCampEffectRed=t.getChildByName("FX").getChildByName("Great2_red"),e.changeCampEffectYellow=t.getChildByName("FX").getChildByName("Great2_yellow"),e.changeCampEffectOrange=t.getChildByName("FX").getChildByName("Great2_oragon"),e.BuildLevelUpEffect=t.getChildByName("FX").getChildByName("Explod"),e.Coillder=t.getChildByName("Coillder"),e.IceEff=t.getChildByName("ice"),e.SnowEff=t.getChildByName("fx_snow"),e.loadingScenc()}))}loadingScenc(){let e=this,t="game/scenes/Conventional/State.ls";"undefined"!=typeof wx&&(t="data2/scenes/Conventional/State.ls"),Laya.Scene3D.load(t,Laya.Handler.create(null,function(t){e.scene=t,Laya.stage.addChild(e.scene),e.initSecne(t);let i=t.getChildByName("MainCamera");e.Maincamera=i,i.enableHDR=!1,e.MainCloneToPos=i.transform.localPosition.clone(),e.MainCloneToRo=i.transform.localRotation.clone(),e.GameUIcamera=t.getChildByName("GameUICamera"),e.SkinUIcamera=t.getChildByName("SkinUICamera"),e.AddBaseScene(t),e.changeToMainCarme(),e.initMainRole(t),t.getChildByName("Env01").transform.localPositionY=0;let a=t.getChildByName("DirectionalLight");a.shadow=!0,a.shadowDistance=3,a.shadowResolution=1024;let n=t.addChild(new Laya.MeshSprite3D(Laya.PrimitiveMesh.createPlane(100,100,1,1)));n.name="plane",e.scene.addChild(n);let s=n.addComponent(Laya.PhysicsCollider),o=new Laya.BoxColliderShape(100,-2,100);n.transform.localPositionY=-.4,s.colliderShape=o,s.friction=2,s.restitution=.3,D.CfgMgr.IsReady=!0,D.EventMgr.event(r.GameIsReady)}))}initMainRole(e){let t=this.Bear;Laya.Sprite3D.instantiate(t,this.MainRole),this.MainRole.getChildAt(0).transform.localPosition=new Laya.Vector3(0,0,0),this.MainRole.getChildAt(0).transform.localRotationEulerY=175,e.addChild(this.MainRole),this.MainRole.getChildAt(0).getChildAt(1).skinnedMeshRenderer.castShadow=!0,this.MainRole.getChildAt(0).getComponent(Laya.Animator).play("idle"),this.changeMainRole(this.MainRole,null),this.MainRole.getChildAt(0).transform.localScale=new Laya.Vector3(.87,.87,.87)}initSecne(e){let t=e.getChildByName("Env01");t.active=!0;let i=e.getChildByName("Env02"),a=e.getChildByName("Env03"),n=e.getChildByName("Env04");this.AllSecens.push(t),this.AllSecens.push(i),this.AllSecens.push(a),this.AllSecens.push(n)}initAllCampBody(){for(let e=0;e<4;e++){let e={UseSword:Math.floor(Math.random()*this.AllWeapon.length),UseShield:Math.floor(Math.random()*this.AllShield.length),UseSkin:Math.floor(Math.random()*this.AllHead.length)};this.AllCampData.push(e)}}changeMainRole(e,t){let i=D.DataMgr.UseSword,a=D.DataMgr.UseShield,n=D.DataMgr.UseSkin;null!=t&&(i=t.UseSword,a=t.UseShield,n=t.UseSkin);let s=e.getChildAt(0).getChildByName("BoneBip01").getChildByName("BoneBip02"),o=s.getChildByName("BoneHead").getChildAt(0),l=s.getChildByName("BoneLHand01").getChildByName("BoneLHand02").getChildByName("BoneLHand03").getChildAt(0),r=s.getChildByName("BoneRHand01").getChildByName("BoneRHand02").getChildByName("BoneRHand03").getChildAt(0);-1==i?l.active=!1:(l.active=!0,l.meshFilter.sharedMesh=this.AllWeapon[i].meshFilter.sharedMesh,l.meshRenderer.material=this.AllWeapon[i].meshRenderer.material),-1==a?r.active=!1:(r.active=!0,r.meshFilter.sharedMesh=this.AllShield[a].meshFilter.sharedMesh,r.meshRenderer.material=this.AllShield[a].meshRenderer.material),o.meshFilter.sharedMesh=this.AllHead[n].meshFilter.sharedMesh,o.meshRenderer.material=this.AllHead[n].meshRenderer.material}loadGame(){this.initBuildingData(this.scene),this.initCollider(this.scene),this.ChooseBg.transform.localPositionY=.4,this.ChooseBg2.transform.localPositionY=.4,this.GameCarme(),this.MainRole.active=!1,this.scene.getChildByName("Lv100").active=!1,this.initAllCampBody()}initLineAndSollide(){for(let e=0;e<500;e++){let e=new Laya.Sprite3D,t=new Laya.Sprite3D;e=this.Bear;this.Bear;Laya.Sprite3D.instantiate(e,t),this.scene.addChild(t)}}changeToMainCarme(){let e=this.GameUIcamera.transform.localPosition,t=this.GameUIcamera.transform.localRotation;Laya.Tween.to(this.Maincamera.transform,{localPositionX:e.x,localPositionY:e.y,localPositionZ:e.z},300),Laya.Tween.to(this.Maincamera.transform,{localRotationX:t.x,localRotationY:t.y,localRotationZ:t.z},300),this.Maincamera.fieldOfView=this.GameUIcamera.fieldOfView}GameCarmechangeToMainCarme(){let e=this.GameUIcamera.transform.localPosition,t=this.GameUIcamera.transform.localRotation;Laya.Tween.to(this.Maincamera.transform,{localPositionX:e.x,localPositionY:e.y,localPositionZ:e.z},1e3),Laya.Tween.to(this.Maincamera.transform,{localRotationX:t.x,localRotationY:t.y,localRotationZ:t.z},1e3),this.Maincamera.fieldOfView=this.GameUIcamera.fieldOfView}changeToSkinCarme(){let e=this.SkinUIcamera.transform.localPosition,t=this.SkinUIcamera.transform.localRotation;Laya.Tween.to(this.Maincamera.transform,{localPositionX:e.x,localPositionY:e.y,localPositionZ:e.z},300),Laya.Tween.to(this.Maincamera.transform,{localRotationX:t.x,localRotationY:t.y,localRotationZ:t.z},300),this.Maincamera.fieldOfView=this.SkinUIcamera.fieldOfView}GameCarme(){let e=this.MainCloneToPos,t=this.MainCloneToRo;Laya.Tween.to(this.Maincamera.transform,{localPositionX:e.x,localPositionY:e.y,localPositionZ:e.z},1e3),Laya.Tween.to(this.Maincamera.transform,{localRotationX:t.x,localRotationY:t.y,localRotationZ:t.z},1e3),this.Maincamera.fieldOfView=58}BackMain(){this.GameCarmechangeToMainCarme(),this.scene.getChildByName("Lv100").active=!0,this.MainRole.active=!0,this.MainRole.getChildAt(0).transform.localRotationEulerY=180,this.MainRole.getChildAt(0).getComponent(Laya.Animator).play("idle")}initMesh(e){let t=e.getChildByName("Player").getChildByName("PlayerHead"),i=e.getChildByName("Player").getChildByName("Sword"),a=e.getChildByName("Player").getChildByName("Shield");for(let e=0;e<t.numChildren;e++)this.AllHead.push(t.getChildAt(e));for(let e=0;e<i.numChildren;e++)this.AllWeapon.push(i.getChildAt(e));for(let e=0;e<a.numChildren;e++)this.AllShield.push(a.getChildAt(e))}initMatial(e){let t=e.getChildByName("AllMatial");if(0!==t.numChildren){for(var i=0;i<t.numChildren;i++){let e=t.getChildAt(i).name;-1!=e.indexOf("Blue")&&this.Camp1Materials.push(t.getChildAt(i)),-1!=e.indexOf("Green")&&this.Camp2Materials.push(t.getChildAt(i)),-1!=e.indexOf("Red")&&this.Camp3Materials.push(t.getChildAt(i)),-1!=e.indexOf("Yellow")&&this.Camp4Materials.push(t.getChildAt(i)),-1!=e.indexOf("Orange")&&this.Camp5Materials.push(t.getChildAt(i)),-1!=e.indexOf("Gay")&&this.Camp6Materials.push(t.getChildAt(i))}this.GayMaterial=t.getChildByName("Gay").meshRenderer.sharedMaterial,this.YellowMaterial=t.getChildByName("Yellow").meshRenderer.sharedMaterial,this.GreenMaterial=t.getChildByName("Green").meshRenderer.sharedMaterial,this.RedMaterial=t.getChildByName("Red").meshRenderer.sharedMaterial,this.BuleMaterial=t.getChildByName("Blue").meshRenderer.sharedMaterial}}initNumAndType(e){let t=e.getChildByName("UI").getChildByName("UI_number");if(this.TypeMeshNormal=t.getChildByName("Type").getChildByName("Lv3").getChildAt(0),this.TypeMeshAttack=t.getChildByName("Type").getChildByName("Lv3").getChildAt(1),this.TypeMeshDefense=t.getChildByName("Type").getChildByName("Lv3").getChildAt(2),this.NumMesh=t.getChildAt(0),0!==t.numChildren)for(var i=0;i<t.numChildren-1;i++){let e=t.getChildAt(i).meshRenderer.material;this.NumMaterials.push(e)}}initBuilding(e){this.NormalBuild=e.getChildByName("NormalBuild"),this.AttackBulid=e.getChildByName("DefenseBuild"),this.DefenseBuild=e.getChildByName("AttackBulid")}AddBaseScene(e){let t=new Laya.MeshSprite3D,i=new Laya.MeshSprite3D;t=this.ChooseBgChild,i=this.ChooseBgChild,Laya.Sprite3D.instantiate(t,this.ChooseBg),Laya.Sprite3D.instantiate(i,this.ChooseBg2)}initBuildingData(e){this.newLevel=D.DataMgr.Level,this.newLevel>50&&(this.newLevel=Math.floor(30*Math.random())+20),D.DataMgr.NewBee&&(this.newLevel=0);let t="Lv"+this.newLevel,i=e.getChildByName(""+t).getChildByName("Building"),a=i.numChildren,n=new Laya.Vector3(0,0,0);if(0!==a)for(var s=0;s<a;s++){let t=s+1,a=i.getChildAt(s);a.active=!1,n.x=a.transform.localPositionX,n.z=a.transform.localPositionZ;let o=new Laya.Sprite3D;this.AllBuilding.push(o),e.addChild(o),o.addComponent(A).initBuild(n,t)}}initCollider(e){D.DataMgr.NewBee&&(this.newLevel=0);let t,i="Lv"+this.newLevel,a=e.getChildByName(""+i).getChildByName("Collider"),n=a.numChildren,s=new Laya.Vector3(0,0,0),o=new Laya.Vector3(0,0,0);if(0!==n)for(var l=0;l<n;l++){let e=new Laya.MeshSprite3D,i=a.getChildAt(l);e=this.Coillder,s=i.transform.localPosition,t=i.transform.localRotation,o=i.transform.localScale;let n=new Laya.Sprite3D;Laya.Sprite3D.instantiate(e,n),this.scene.addChild(n),this.AllCollider.push(n),n.transform.localPosition=s,n.transform.localRotation=t,n.transform.localScale=o;let r=n.addComponent(Laya.Rigidbody3D);n.name="collider";let h=new Laya.BoxColliderShape(1,1,1);r.colliderShape=h,r.mass=10,r.linearFactor=new Laya.Vector3(0,0,0)}}CreatBulindLine(e){if(null===this.ChooseBox)return;let t=this.ChooseBox.getComponent(A),i=e.getComponent(A);if(!t.checkCanCreatLine(e))return;let a=I.Distance2(this.startPoint,this.endPoint),n=I.Rotation2D(this.startPoint,this.endPoint),s=new Laya.Sprite3D;this.scene.addChild(s);let o=s.addComponent(L),l={start:this.ChooseBox,end:e,length:a,rot:n,id:this.BuildIngLineIndex,camp:t.camp};o.initData(l),t.changeTarget(e,s),this.BuildIngLineIndex++,1===t.camp&&this.MainBuildLine.push(s),i.checkNeedCreatLine(this.ChooseBox)}DestoryBuildLine(){let e=this.MainBuildLine.length,t=new Laya.Vector2,i=new Laya.Vector2;if(0!==e)for(var a=0;a<e;a++){let e=this.MainBuildLine[a],n=e.getComponent(L);if(t.x=n.startBuild.transform.localPositionX,t.y=n.startBuild.transform.localPositionZ,i.x=n.endBuild.transform.localPositionX,i.y=n.endBuild.transform.localPositionZ,I.Intersection(t,i,this.clearStartPoint,this.clearEndPoint)){let t=n.startBuild,i=n.endBuild;t.getComponent(A).ClearTarget(i),e.active=!1}}}refreshChooseBox(){let e=B.findHitResult(),t=new Laya.Vector2;if(this.firstClick&&(this.firstClick=!1,this.scene.addChild(this.ChooseLine),this.scene.addChild(this.ChooseBg),this.scene.addChild(this.ChooseBg2)),e.succeeded){let i=e.collider.owner.name;if(t.x=e.collider.owner.transform.localPositionX,t.y=e.collider.owner.transform.localPositionZ,"build"===i){let i=e.collider.owner.getComponent(A);if(1!=i.camp)return void(this.ChooseBox=null);D.SoundMgr.playSound("sound/choose.mp3"),this.ChooseBg.active=!0,this.ChooseLine.active=!0,this.ChooseLine.transform.localScaleZ=0,this.ChooseBg2.active=!0,this.ChooseBox=e.collider.owner,this.ChooseBg.transform.localPositionX=t.x,this.ChooseBg.transform.localPositionY=.6,this.ChooseBg.transform.localPositionZ=t.y,this.ChooseLine.transform.localScaleY=.3,this.ChooseBg2.transform.localPositionX=t.x,this.ChooseBg2.transform.localPositionY=.6,this.ChooseBg2.transform.localPositionZ=t.y,this.startPoint=t,i.TargetBuild.length<i.MaxLines?Laya.timer.frameLoop(1,this,this.checkCanCast):this.ChooseLine.meshRenderer.sharedMaterial=this.RedMaterial}else this.ChooseBg.active=!1,this.ChooseLine.active=!1,t.x=e.point.x,t.y=e.point.z,this.clearStartPoint=t}else this.ChooseBg.active=!1,this.ChooseLine.active=!1}creatLine(){let e=B.findHitResult(),t=new Laya.Vector2;if(e.succeeded){e.collider.owner.name;t.x=e.point.x,t.y=e.point.z;let i=I.Distance2(this.startPoint,t),a=I.Rotation2D(this.startPoint,t),n=(t.x-this.startPoint.x)/2+this.startPoint.x,s=(t.y-this.startPoint.y)/2+this.startPoint.y;this.ChooseLine.transform.localRotationEulerY=a+90,this.ChooseLine.transform.localScaleZ=1.6*i,this.ChooseLine.transform.localPosition=new Laya.Vector3(n,.5,s),this.ChooseBg2.transform.localPositionX=t.x,this.ChooseBg2.transform.localPositionY=.2,this.ChooseBg2.transform.localPositionZ=t.y}}destryLine(){this.ChooseLine.active=!1,this.ChooseBg.active=!1,this.ChooseBg2.active=!1;let e=new Laya.Vector2;Laya.timer.clear(this,this.checkCanCast);let t=B.findHitResult();if(t.succeeded){let i=t.collider.owner;if(e.x=t.point.x,e.y=t.point.z,"build"===i.name){if(i===this.ChooseBox)return;if(!this.checkCanCast())return;D.SoundMgr.playSound("sound/line.mp3"),D.DataMgr.NewBee&&T.instance.finger.visible&&Laya.timer.once(500,null,function(){T.instance.NewBeeNext()}),this.endPoint.x=i.transform.localPositionX,this.endPoint.y=i.transform.localPositionZ,this.CreatBulindLine(i)}else D.SoundMgr.playSound("sound/cut.mp3"),this.clearEndPoint=e,this.DestoryBuildLine()}}checkCanCast(){let e=new Laya.HitResult;this.scene.physicsSimulation.raycastFromTo(this.ChooseBg.transform.localPosition,this.ChooseBg2.transform.localPosition,e);let t=e.point;if(e.succeeded){if("collider"==e.collider.owner.name)return this.ChooseLine.meshRenderer.sharedMaterial=this.RedMaterial,!1;if("build"==e.collider.owner.name){let e=t.x-this.ChooseBg2.transform.localPositionX,i=t.z-this.ChooseBg2.transform.localPositionZ;return Math.sqrt(e*e+i*i)<4?(this.ChooseLine.meshRenderer.sharedMaterial=this.BuleMaterial,!0):(this.ChooseLine.meshRenderer.sharedMaterial=this.RedMaterial,!1)}return this.ChooseLine.meshRenderer.sharedMaterial=this.BuleMaterial,!0}return this.ChooseLine.meshRenderer.sharedMaterial=this.BuleMaterial,!0}chooseMesh(e,t){let i=new Laya.BlinnPhongMaterial,a=[];switch(e){case 1:a=this.Camp1Materials;break;case 2:a=this.Camp2Materials;break;case 3:a=this.Camp3Materials;break;case 4:a=this.Camp4Materials;break;case 5:a=this.Camp5Materials;break;case 6:a=this.Camp6Materials}if(!(t>a.length))return i=a[t-1].meshRenderer.sharedMaterial}chooseShuriKenParticle3D(e){let t=new Laya.Sprite3D;switch(e){case 1:t=this.changeCampEffectBule;break;case 2:t=this.changeCampEffectGreen;break;case 3:t=this.changeCampEffectRed;break;case 4:t=this.changeCampEffectYellow;break;case 5:t=this.changeCampEffectOrange}return t}startGame(){this.isShowInt=!1,Laya.timer.frameLoop(1,this,this.update),Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.refreshChooseBox),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.creatLine),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.destryLine),this.loadGame(),this.isIce&&this.IceDestory(),D.DataMgr.NewBee&&this.pauseGame()}IceDestory(){if(0!=this.AllBuilding.length)for(let e=0;e<this.AllBuilding.length;e++){let t=this.AllBuilding[e].getComponent(A);1!=t.camp&&6!=t.camp&&t.showIceEffect()}Laya.timer.once(3e4,this,()=>{this.isIce=!1})}pauseGame(){Laya.timer.clear(this,this.update)}contiueGame(){Laya.timer.frameLoop(1,this,this.update)}GameOver(){Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.refreshChooseBox),Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.creatLine),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.destryLine),Laya.timer.clear(this,this.update)}clearGame(){if(this.isDb=!1,this.isIce=!1,0!=this.AllBuilding.length)for(let e=0;e<this.AllBuilding.length;e++){this.AllBuilding[e].getComponent(A).clear(),this.scene.removeChild(this.AllBuilding[e]),this.AllBuilding[e].destory}if(0!=this.AllCollider.length)for(let e=0;e<this.AllCollider.length;e++)this.scene.removeChild(this.AllCollider[e]),this.AllCollider[e].destory;if(0!=this.AllSoliders.length)for(let e=0;e<this.AllSoliders.length;e++)this.scene.removeChild(this.AllSoliders[e]),this.AllSoliders[e].destory;if(this.SoliderNum=0,0!=this.AllBuildingLine.length)for(let e=0;e<this.AllBuildingLine.length;e++)this.scene.removeChild(this.AllBuildingLine[e]),this.AllBuildingLine[e].destory;if(0!=this.AllEffect.length)for(let e=0;e<this.AllEffect.length;e++)this.AllEffect[e]&&(this.scene.removeChild(this.AllEffect[e]),this.AllEffect[e].destory);this.AllEffect=[],this.AllBuilding=[],this.AllBuildingLine=[],this.AllSoliders=[],this.firstClick=!0,this.scene.removeChild(this.ChooseLine),this.scene.removeChild(this.ChooseBg),this.scene.removeChild(this.ChooseBg2)}update(){let e=0,t=0,i=0;T.instance.initMask();for(let a=0;a<this.AllBuilding.length;a++){let n=this.AllBuilding[a].getComponent(A);1===n.camp?(e++,t+=n.Level):i+=n.Level,n.update()}if(0!=this.AllSoliders.length)for(let e=0;e<this.AllSoliders.length;e++)if(this.AllSoliders[e].active){this.AllSoliders[e].getComponent(b).update()}if(0!=this.AllBuildingLine.length)for(let e=0;e<this.AllBuildingLine.length;e++)if(this.AllBuildingLine[e].active){this.AllBuildingLine[e].getComponent(L).update()}0===e&&T.instance.fail(),e>=this.AllBuilding.length&&T.instance.Win()}}class _{constructor(){this._pool=new Array}Initialization(){this._bomb=D.ResMgr.GetRes(m.Bomb).getChildAt(0);for(let t=0;t<10;t++){var e=this.createEff();this.Despawn(e)}}createEff(){return Laya.Sprite3D.instantiate(this._bomb,this._obj)}GetEffect(){if(this._pool.length>0){var e=this._pool.pop();return e.active=!0,this._obj.removeChild(e),e}return this.createEff()}Despawn(e){this._obj.addChild(e),e.particleSystem.stop(),e.active=!1,this._pool.push(e)}}class D{constructor(){}static SetupEngine(){D.CfgMgr=new y,D.ResMgr=new f,D.DataMgr=new w,D.EventMgr=new i,D.SoundMgr=new C,D.UIMgr=new l,D.SceneMgr=new x,D.GameMgr=new v,D.EffMgr=new _,window.EventMgr=D.EventMgr,window.SoundMgr=D.SoundMgr,window.UIMgr=D.UIMgr,window.platform||(window.platform=new s)}}class N{constructor(){}static getRandomNum(e){let t=0;return t=Math.floor(Math.random()*e)}static getUIPos(e){let t=D.SceneMgr.Maincamera,i=new Laya.Vector4;t.viewport.project(e,t.projectionViewMatrix,i);let a=new Laya.Vector2;return a.x=i.x,a.y=i.y,a}static showTime(e){let t=e%60,i=Math.floor(e/60),a="",n="";return(n=i<10?"0"+i:""+i)+":"+(a=t<10?"0"+t:""+t)}static outMainPlayer(e,t){let i=e.x-t.x,a=e.z-t.z;return i*i+a*a>14400}static checkPosInMid([e,t]){let i=e,a=t;return i-Laya.stage.width/2>0&&i-Laya.stage.width/2<50&&(i=Laya.stage.width/2+50),i-Laya.stage.width/2<0&&i-Laya.stage.width/2>-50&&(i=Laya.stage.width/2-50),a-Laya.stage.height/2>0&&a-Laya.stage.height/2<50&&(a=Laya.stage.height/2+50),a-Laya.stage.height/2<0&&a-Laya.stage.height/2>-50&&(a=Laya.stage.height/2-50),[i,a]}static checkPosOutView([e,t]){let i=Laya.stage.width/2,a=Laya.stage.height/2,n=e-i,s=t-a,o=0,l=0,r=180*Math.atan(Laya.stage.width/Laya.stage.height)/Math.PI,h=Math.sqrt(n*n+s*s),d=(Math.asin(s/h),Math.PI,Math.abs(180*Math.asin(s/h)/Math.PI));n>0?s<0&&(d=360-d):s<0?d+=180:d=180-d;let g=[360-r,r-1],c=[r,179-r],p=[180-r,179+r];return d>g[0]||d<g[1]?(o=Laya.stage.width-70,l=s*i/n+a):d>c[0]&&d<c[1]?(l=Laya.stage.height,o=n*a/s+i):d>p[0]&&d<p[1]?(o=0,l=-s*i/n+a):(l=400,o=-n*(a-400)/s+i,o=Math.min(Laya.stage.width-70,o),o=Math.max(0,o)),[o,l]}static getTweenNum(e,t,i){return e=Math.max(t,e),e=Math.min(e,i)}Tool(){}}let P={FirstGameUI:{id:0,class:"script/view/FirstGameUI.ts",adunit:[]},LoadingUI:{id:1,class:"script/view/LoadingUI.ts",adunit:[]},GameUI:{id:2,class:"script/view/GameUI.ts",adunit:[g,c,p]},ResultUI:{id:3,class:"script/view/ResultUI.ts",adunit:[]},BattleUI:{id:4,class:"script/view/BattleUI.ts",adunit:[]},SevenDayUI:{id:5,class:"script/view/SevenDay.ts",adunit:[]},DialUI:{id:6,class:"script/view/Dial.ts",adunit:[]},ResurrectionUI:{id:7,class:"script/view/ResurrectionUI.ts",adunit:[g,c,p]},GetFreeCoinUI:{id:9,class:"script/view/GetFreeCoinUI.ts",adunit:[g,c,p]},TaskAndAchievementUI:{id:10,class:"script/view/TaskAndAchievementUI.ts",adunit:[]},DailyUI:{id:11,class:"script/view/DailyUI.ts",adunit:["adunit-1278899a3b3dcef3"],tween:!0},ShopUI:{id:16,class:"script/view/ShopUI.ts",adunit:[]},UnlockCar:{id:17,class:"script/view/UnlockCarUI.ts",adunit:["adunit-cff522a9a5b0da6e"]},SkinUI:{id:18,class:"script/view/SkinUI.ts",adunit:["adunit-cff522a9a5b0da6e"],tween:!0},NewPlayerUI:{id:19,class:"script/view/NewPlayerUI.ts",adunit:[]}};class U{constructor(){}static getName(e){for(let t=0;t<U.data.length;t++)if(U.data[t].cn==e)return U.data[t][o.language]}static setNameLength(e){return e.length>7?e.substring(0,7)+"...":e}}U.data=[{cn:"挑战失败","en-us":"Challenge failed","pt-br":"Desafio fracassado",vi:"Khiêu chiến thất bại",id:"Tantangan gagal"},{cn:"任务目标","en-us":"Task goal","pt-br":"Objetivo da tarefa",vi:"Mục tiêu nhiệm vụ",id:"Tujuan tugas"},{cn:"怎么玩","en-us":"How to play","pt-br":"Como jogar",vi:"Cách chơi",id:"Cara bermain"},{cn:"音乐","en-us":"Music","pt-br":"Música",vi:"Nhạc",id:"Musik"},{cn:"关","en-us":"Off","pt-br":"Desativado",vi:"Tắt",id:"Nonaktif"},{cn:"开","en-us":"On","pt-br":"Ativado",vi:"Bật",id:"Aktif"},{cn:"音效","en-us":"SFX","pt-br":"Efeitos Sonoros",vi:"SFX",id:"SFX"},{cn:"震动","en-us":"Vibration","pt-br":"Vibração",vi:"Rung",id:"Getaran"},{cn:"完美","en-us":"Perfect","pt-br":"Perfeito",vi:"Hoàn hảo",id:"Sempurna"},{cn:"算了","en-us":"No, thanks","pt-br":"Não, obrigado",vi:"Không, cảm ơn",id:"Tidak, terima kasih"},{cn:"继续","en-us":"Continue","pt-br":"Continuar",vi:"Tiếp tục",id:"Lanjutkan"},{cn:"关卡","en-us":"Level","pt-br":"Nível",vi:"Màn",id:"Level"},{cn:"下一个区域","en-us":"Next zone","pt-br":"Próxima zona",vi:"Vùng tiếp theo",id:"Zona berikutnya"},{cn:"好的","en-us":"OK","pt-br":"OK",vi:"OK",id:"Oke"},{cn:"重试","en-us":"Retry","pt-br":"Tentar de novo",vi:"Thử lại",id:"Coba lagi"},{cn:"开始游戏","en-us":"PLAY","pt-br":"Começar jogo",vi:"Bắt đầu chơi",id:"Mulai game"},{cn:"完成教程","en-us":"Complete the tutorial","pt-br":"Conclua o tutorial",vi:"Hoàn thành hướng dẫn",id:"Selesaikan tutorial"},{cn:"拖动并连接","en-us":"Drag and link","pt-br":"Arraste e conecte",vi:"Kéo và liên kết",id:"Seret dan hubungkan"},{cn:"切断连接","en-us":"Cut the link","pt-br":"Corte a conexão",vi:"Cắt liên kết",id:"Putuskan hubungannya"},{cn:"攻击大楼","en-us":"Attack building","pt-br":"Atacar edifício",vi:"Tấn công tòa nhà",id:"Serang bangunan"},{cn:"防守大楼","en-us":"Defend building","pt-br":"Defender edifício",vi:"Bảo vệ tòa nhà",id:"Lindungi bangunan"},{cn:"免费获得","en-us":"Free to get","pt-br":"Grátis para obter",vi:"Nhận miễn phí",id:"Dapat gratis"},{cn:"任务目标","en-us":"Task goal","pt-br":"Objetivo da tarefa",vi:"Mục tiêu nhiệm vụ",id:"Tujuan tugas"},{cn:"占领所有大楼获得胜利","en-us":"Take over all buildings to win","pt-br":"Ocupe todos os edifícios para vencer",vi:"Chiếm lấy tòa nhà để thắng",id:"Kuasai semua bangunan untuk menang"},{cn:"完成","en-us":"Completed","pt-br":"Concluído",vi:"Hoàn thành",id:"Selesai"},{cn:"完成教程","en-us":"Complete tutorial","pt-br":"Conclua o tutorial",vi:"Hoàn thành hướng dẫn",id:"Selesaikan tutorial"},{cn:"奖励","en-us":"Reward","pt-br":"Recompensa",vi:"Phần thưởng",id:"Hadiah"},{cn:"挑战失败","en-us":"Challenge failed","pt-br":"Desafio fracassado",vi:"Khiêu chiến thất bại",id:"Tantangan gagal"},{cn:"失败了","en-us":"Failed","pt-br":"Fracassou",vi:"Thất bại",id:"Gagal"},{cn:"重新再试一次吧！","en-us":"Try one more time!","pt-br":"Tente mais uma vez!",vi:"Thử lại lần nữa!",id:"Coba sekali lagi!"},{cn:"拖动并连接","en-us":"Drag and link","pt-br":"Arraste e conecte",vi:"Kéo và liên kết",id:"Seret dan hubungkan"},{cn:"用手指滑动可以创建大楼之间的连接","en-us":"Swipe to link the two buildings","pt-br":"Deslize para conectar os dois edifícios",vi:"Quẹt để liên kết hai tòa nhà",id:"Usap untuk menghubungkan dua bangunan"},{cn:"切断连接","en-us":"Cut the link","pt-br":"Corte a conexão",vi:"Cắt liên kết",id:"Putuskan hubungannya"},{cn:"用手指滑过连接线可以切断大楼之间的连接","en-us":"Swipe the line between the two buildings to cut it","pt-br":"Deslize a linha entre os dois edifícios para cortá-la",vi:"Quẹt đường thắng giữa hai tòa nhà để cắt",id:"Usap garis di antara dua bangunan untuk memotongnya"},{cn:"三角大楼双倍攻击力","en-us":"Triangle shaped building's attack doubles","pt-br":"O ataque do edifício em forma de triângulo é dobrado",vi:"Tòa nhà tam giác nhân đôi công kích",id:"Serangan bangunan berbentuk segitiga menjadi dua kali lipat"},{cn:"圆形大楼双倍治愈力","en-us":"Round shaped building's healing effects doubles","pt-br":"Os efeitos de cura do edifício redondo são dobrados",vi:"Tòa nhà hình tròn nhân đôi hiệu ứng trị thương",id:"Efek penyembuhan bangunan berbentuk lingkaran menjadi dua kali lipat"},{cn:"方块占领","en-us":"Building taken over","pt-br":"Edifício ocupado",vi:"Đã chiếm tòa nhà",id:"Bangunan dikuasai"},{cn:"金币不足","en-us":"Not enough coins","pt-br":"Moedas insuficientes",vi:"Không đủ xu",id:"Koin tidak cukup"},{cn:"加载中...","en-us":"Loading...","pt-br":"Carregando...",vi:"Đang tải...",id:"Memuat..."},{cn:"暂未开放","en-us":"Not open","pt-br":"Não aberto",vi:"Chưa mở",id:"Tidak terbuka"}];class T extends e.view.BattleUIUI{constructor(){super(),this.CampList=[],this.canAni=!0,this.isShowInt=!0,this.winGold=0,this.isClickIceBtn=!1,T.instance=this}onAwake(){this.txt_lv.text=U.getName("关卡"),this.NewBeeTips.getChildAt(0).text=U.getName("占领所有大楼获得胜利"),this.NewBeeNextBtn.getChildAt(0).text=U.getName("好的"),this.NeeBeeBox.getChildAt(0).text=U.getName("完成教程"),this.NormalBox.getChildAt(0).text=U.getName("完成")+":",this.txt_award.text=U.getName("奖励"),this.ADBtn.getChildAt(1).text=U.getName("奖励")+"X 2",this.faileBox.getChildAt(1).text=U.getName("挑战失败"),this.faileBox.getChildAt(3).text=U.getName("重新再试一次吧！"),this.goBackBtn.getChildAt(0).text=U.getName("算了"),this.AgBtn.getChildAt(0).text=U.getName("重试"),this.NextBtn.getChildAt(0).text=U.getName("继续"),console.log("初始化战斗界面成功！"),this.initEvent(),this.initView(),"skin"==D.CfgMgr.openScene&&D.UIMgr.closeUI(P.SkinUI),D.CfgMgr.openScene="battle",this.refreshGold(),this.GoldBox.visible=!1}initView(){D.CfgMgr.PlayGameCnt>=3&&(D.CfgMgr.PlayGameCnt=0,this.ADBtn.visible=!0,this.NextBtn.visible=!1,Laya.timer.once(3e3,this,()=>{this.CloseWinBtn.visible=!0})),this.isShowInt=!1,this.initMask(),D.DataMgr.NewBee&&(this.NewBeeAni(),this.LevelCnt.visible=!1),this.LevelNum.value=D.DataMgr.Level}initEvent(){this.BackBtn.on("click",this,this.backMain),this.goBackBtn.on("click",this,this.goBackClick),this.AgBtn.on("click",this,this.AgBtnClick),this.NextBtn.on("click",this,this.NextBtnClick),this.NewBeeNextBtn.on("click",this,this.CloseNewBeeNext),this.CloseWinBtn.on("click",this,this.NextBtnClick),this.ADBtn.on("click",this,this.ADBtnBox),this.IceBtn.on("click",this,this.DoubleClick)}DoubleClick(){D.SoundMgr.playBtnClick(),D.SceneMgr.pauseGame(),o.createRewardedVideoAd(e=>{if(e){if(D.SceneMgr.isIce=!0,this.isClickIceBtn=!0,this.IceBtn.visible=!1,0!=D.SceneMgr.AllBuilding.length)for(let e=0;e<D.SceneMgr.AllBuilding.length;e++){let t=D.SceneMgr.AllBuilding[e].getComponent(A);1!=t.camp&&6!=t.camp&&t.showIceEffect()}setTimeout(()=>{D.SceneMgr.isIce=!1},3e4),D.SceneMgr.contiueGame()}else D.SceneMgr.contiueGame()})}NewBeeAni(){this.BackBtn.off("click",this,this.backMain);let e=D.SceneMgr.AllBuilding[1],t=D.SceneMgr.AllBuilding[3];this.Mainpos=N.getUIPos(e.transform.localPosition),this.Targetpos=N.getUIPos(t.transform.localPosition),this.finger.visible=!0,this.finger.x=this.Mainpos.x,this.finger.y=this.Mainpos.y,this.fingerUp()}fingerUp(){this.finger.visible&&Laya.Tween.to(this.finger,{y:this.Targetpos.y},1e3,null,Laya.Handler.create(this,()=>{Laya.timer.once(200,this,()=>{this.finger.y=this.Mainpos.y,this.fingerUp()})}))}NewBeeNext(){this.finger.visible=!1,this.NewBeeTips.visible=!0,Laya.timer.once(3e3,this,()=>{this.CloseNewBeeNext()})}CloseNewBeeNext(){this.NewBeeTips.visible&&(this.NewBeeTips.visible=!1,D.SceneMgr.contiueGame(),D.SceneMgr.AllCollider[4].transform.localPosition=new Laya.Vector3(-100,0,0))}refreshGold(){this&&(this.GoldCnt.text=""+D.DataMgr.goldCount)}initMask(){let e=D.SceneMgr.AllBuilding,t=0,i=0,a=0,n=0,s=0,o=0;if(0!=e.length)for(let o=0;o<e.length;o++){let l=e[o].getComponent(A),r=l.camp,h=l.Level;h=Math.max(h,0),1===r&&(t+=l.SoliderAliveNum+h),2===r&&(a+=l.SoliderAliveNum+h),3===r&&(i+=l.SoliderAliveNum+h),4===r&&(n+=l.SoliderAliveNum+h),5===r&&(s+=l.SoliderAliveNum+h)}o=t+a+i+n+s;let l=Math.floor(t/o*500),r=l+Math.floor(a/o*500),h=r+Math.floor(i/o*500),d=h+Math.floor(n/o*500);this.blueMask.mask.width=l,this.blueMask.mask.width<=50&&!this.isClickIceBtn&&(this.IceBtn.visible=!0),this.GreenMask.mask.width=Math.floor(a/o*500),this.RedMask.mask.width=Math.floor(i/o*500),this.YellowMask.mask.width=Math.floor(n/o*500),this.OrangeMsk.mask.width=Math.floor(s/o*500),this.GreenMask.mask.x=a<=0?-1e3:l,this.RedMask.mask.x=i<=0?-1e3:r,this.YellowMask.mask.x=n<=0?-1e3:h,this.OrangeMsk.mask.x=s<=0?-1e3:d}fail(){D.DataMgr.loginNum>1&&o.interstitialAd(),this.IceBtn.visible=!1,D.SceneMgr.GameOver(),this.GoldBox.visible=!0,this.faileBox.visible=!0,this.failText.text=U.getName("关卡")+D.DataMgr.Level+U.getName("失败了"),o.createBannerAd()}Win(){D.DataMgr.loginNum>1&&o.interstitialAd(),this.IceBtn.visible=!1,D.CfgMgr.PlayGameCnt++,D.SceneMgr.GameOver(),this.winGold=Math.floor(50*Math.random())+25,this.GoldNum.text=""+this.winGold,this.GoldBox.visible=!0,this.WinBox.visible=!0,this.BearBox.scale(0,0),Laya.Tween.to(this.BearBox,{scaleX:1,scaleY:1},1e3),this.LevelCnt.value=D.DataMgr.Level,this.NeeBeeBox.visible=D.DataMgr.NewBee,this.NormalBox.visible=!D.DataMgr.NewBee,D.DataMgr.NewBee?D.DataMgr.NewBee=!1:D.DataMgr.Level++,o.createBannerAd()}ADBtnBox(){let e=2*this.winGold,t=this;o.createRewardedVideoAd(function(i){if(i){if(!t)return;D.DataMgr.addGoldCount(e),t.refreshGold(),D.SoundMgr.playBtnClick(),D.SceneMgr.clearGame(),t.close()}})}backMain(){D.SoundMgr.playBtnClick(),D.SceneMgr.GameOver(),D.SceneMgr.clearGame(),this.close(),this.faileBox.visible=!1,this.WinBox.visible=!1}goBackClick(){D.SoundMgr.playBtnClick(),D.SceneMgr.clearGame(),this.close()}AgBtnClick(){D.SoundMgr.playBtnClick(),D.SceneMgr.clearGame(),D.SceneMgr.startGame(),this.faileBox.visible=!1}NextBtnClick(){D.DataMgr.addGoldCount(this.winGold),this.refreshGold(),D.SoundMgr.playBtnClick(),D.SceneMgr.clearGame(),this.close()}close(){console.log("界面关闭"),o.closeBannerAd(),D.UIMgr.openUI(P.GameUI),D.SceneMgr.BackMain(),super.close()}}class G extends e.view.GameUIUI{constructor(){super(),this._rollingState=1,this._timeText=3,this._rotation=0,this._showSkinArr=null,this._skinIndex=0,this.GameTime=0,this.clickNum=0,G.instance=this,this._showSkinArr=new Array}onAwake(){this.startbtn.getChildAt(0).text=U.getName("开始游戏"),this.Next.getChildAt(2).text=U.getName("下一个区域"),this.tips_txt.text=U.getName("三角大楼双倍攻击力"),this.tips_close.getChildAt(0).text=U.getName("好的"),this.initView(),this.addEvent(),D.CfgMgr.playMuisc?(this.btn_on.visible=!0,this.btn_off.visible=!1):(this.btn_on.visible=!1,this.btn_off.visible=!0)}initView(){this.refreshGold(),this.showScene(),o.closeBannerAd(),D.DataMgr.isSameDay||(this.Tips.visible=!0)}addEvent(){this.SkinBtn.on("click",this,this.SkinBtnClick),this.Next.on("click",this,this.changeScene),this.startbtn.on("click",this,this.StartGame),this.DoubleBtn.on("click",this,this.DoubleClick),this.IceBtn.on("click",this,this.IceClick),this.tips_close.on("click",this,this.setTips),this.btn_music.on("click",this,this.setMusic)}setMusic(){D.SoundMgr.playBtnClick(),this.btn_on.visible?(this.btn_on.visible=!1,this.btn_off.visible=!0,D.CfgMgr.playMuisc=!1,D.SoundMgr.stopBGM()):(this.btn_on.visible=!0,this.btn_off.visible=!1,D.CfgMgr.playMuisc=!0,D.SoundMgr.playBGM())}setTips(){D.SoundMgr.playBtnClick(),this.clickNum<1?(this.clickNum++,this.tips_img.skin="game/tutorial_4.png",this.tips_txt.text=U.getName("圆形大楼双倍治愈力")):(D.DataMgr.addIsSameDay(!0),this.Tips.visible=!1)}SkinBtnClick(){D.SoundMgr.playBtnClick(),this.LOGO.visible=!1,D.UIMgr.openUI(P.SkinUI)}DoubleClick(){D.SoundMgr.playBtnClick(),o.createRewardedVideoAd(e=>{if(e){if(!this)return;D.SceneMgr.isDb=!0,this.DoubleBtn.visible=!1}})}IceClick(){D.SoundMgr.playBtnClick(),o.createRewardedVideoAd(e=>{if(e){if(!this)return;D.SceneMgr.isIce=!0,this.IceBtn.visible=!1,D.SceneMgr.IceDestory()}})}rollBtnnClick(){D.UIMgr.openUI(P.DialUI)}refreshGold(){this&&(this.GoldCnt.text=""+D.DataMgr.goldCount)}changeScene(){D.SoundMgr.playBtnClick(),D.DataMgr.MaxScene>=4?this.Next.getChildAt(1).text=U.getName("暂未开放"):1e3>D.DataMgr.goldCount?D.UIMgr.showTips(U.getName("金币不足")):(D.DataMgr.addGoldCount(-1e3),D.DataMgr.MaxScene++,this.refreshGold(),this.showScene())}showScene(){let e=D.SceneMgr.AllSecens.length;if(0!==e)for(let t=0;t<e;t++)t+1===D.DataMgr.MaxScene?D.SceneMgr.AllSecens[t].active=!0:D.SceneMgr.AllSecens[t].active=!1}checkGoldCnt(e,t){return D.DataMgr.goldCount-t>=0}StartGame(){D.SoundMgr.playBtnClick(),D.SceneMgr.startGame(),D.UIMgr.closeUI(P.GameUI),D.UIMgr.openUI(P.BattleUI)}}G.lastInsertTime=0,G.nativetime=0,G.nativetime2=0;class R extends e.view.DialUI{constructor(){super(),this.m_speed=15,this.date=[{gold:20,weight:200},{gold:100,weight:200},{gold:200,weight:200},{gold:50,weight:200},{gold:400,weight:100},{gold:500,weight:100}],this.Minlastrotation=0,this.Maxlastrotation=0,this.lastrotation=0,this.addGold=0}onAwake(){console.log("初始化战斗界面成功！"),this.initView(),this.initEvent()}initView(){this.CloseBtn.disabled=!1,this.WatchAdBtn.disabled=!1}initEvent(){this.CloseBtn.on("click",this,this.close),this.WatchAdBtn.on("click",this,this.WatchAd)}WatchAd(){}getRewardData(){this.CloseBtn.disabled=!0,this.WatchAdBtn.disabled=!0;for(var e=[],t=0,i=0;i<this.date.length;i++){for(var a=this.date[i].weight,n=0;n<a;n++)e.push(i);t+=a}var s=e[Math.floor(Math.random()*t)];this.addGold=this.date[s].gold,this.Minlastrotation=s*(360/this.date.length)%360,this.Maxlastrotation=(s+1)*(360/this.date.length)%360,0!==this.Maxlastrotation?this.Maxlastrotation=(s+1)*(360/this.date.length)%360:this.Maxlastrotation=360,Laya.timer.loop(1,this,this.addspeedhandspin)}addspeedhandspin(){this.dialsss.rotation+=this.m_speed,this.lastrotation=this.dialsss.rotation%360,this.m_speed<=40&&(this.m_speed+=.02*this.m_speed),this.m_speed>40&&(Laya.timer.clear(this,this.addspeedhandspin),Laya.timer.loop(1,this,this.handspin))}handspin(){this.dialsss.rotation+=this.m_speed,this.lastrotation=this.dialsss.rotation%360,this.m_speed>=5&&(this.m_speed-=.025*this.m_speed);var e=this.Maxlastrotation-40;this.m_speed<=5&&this.lastrotation>=this.Minlastrotation&&this.lastrotation<=e&&this.Endhandspin()}Endhandspin(){Laya.timer.clear(this,this.handspin),this.CloseBtn.disabled=!1,this.WatchAdBtn.disabled=!1,D.DataMgr.addGoldCount(this.addGold),G.instance.refreshGold(),D.UIMgr.showTips("恭喜获得"+this.addGold+"金币")}close(){console.log("界面关闭"),super.close()}}class O extends e.view.LoadingUI{constructor(){super(),this.currentFarm=0,this.isOK=!1}onAwake(){D.EventMgr.on(r.Res_Load_Complete,this,this.complete),D.EventMgr.on(r.GameIsReady,this,this.ReadyGame),D.EventMgr.on(r.Res_Load_Progress,this,this.updateBar),D.ResMgr.preLoadRes(),this.txt_loding.text=U.getName("加载中..."),D.DataMgr.loginNum++}complete(e=0){e<100||(this.isOK=!0,D.CfgMgr.IsReady&&(D.UIMgr.closeUI(P.LoadingUI),D.DataMgr.NewBee?(D.SceneMgr.startGame(),D.UIMgr.toUI(P.BattleUI)):D.UIMgr.toUI(P.GameUI)))}ReadyGame(){D.CfgMgr.IsReady&&this.isOK&&(D.UIMgr.closeUI(P.LoadingUI),D.DataMgr.NewBee?(D.SceneMgr.startGame(),D.UIMgr.toUI(P.BattleUI)):D.UIMgr.toUI(P.GameUI))}updateBar(e){e>1&&(e=1)}close(){D.EventMgr.off(r.GameIsReady,this,this.ReadyGame),super.close(),o.onLoading()}}class V extends e.view.SevenDayUI{constructor(){super(),this.RewardList=[300,500,550,600,800,1e3,1200],this.ADBtn=!0,this.nativeObj=null}onAwake(){this.initView(),this.initEvent()}initView(){this.refreshGetDay(),this.addNative()}initEvent(){this.CloseBtn.on("click",this,this.close),this.GetAdBtn.on("click",this,this.WathAd),this.UseADBtn.on("click",this,this.changeAD),this.NormalBtn.on("click",this,this.NormalBtnClick)}refreshGetDay(){let e=D.DataMgr.canGetDay,t=D.DataMgr.IsGetDay;e>t?(this.NormalBtn.disabled=!1,this.GetAdBtn.disabled=!1):(this.NormalBtn.disabled=!0,this.GetAdBtn.disabled=!0);for(let i=1;i<=7;i++){let a=this["Day"+i],n=a.getChildByName("msk"),s=a.getChildByName("getImg");n.visible=!(e>i-1),s.visible=t>=i}}WathAd(){}getReward(e){let t=D.DataMgr.canGetDay,i=D.DataMgr.IsGetDay,a=this.RewardList[i];e&&(a*=2),i>=t?D.UIMgr.showTips("请明日再来"):(D.DataMgr.addGoldCount(a),G.instance.refreshGold(),D.UIMgr.showTips("恭喜获得"+a+"金币"),D.DataMgr.IsGetDay++,this.refreshGetDay())}NormalBtnClick(){this.getReward(!1),this.close()}changeAD(){let e=!this.ADBtn;this.ADBtn=e,this.UseADImg.visible=e,this.GetAdBtn.getChildAt(0).visible=e,this.GetAdBtn.getChildAt(1).centerX=e?37:0}addNative(){}close(){super.close()}}class z extends e.view.SkinUIUI{constructor(){super(),this.RewardList=[300,500,550,600,800,1e3,1200],this.ADBtn=!0,this.SkinListArr=[],this.LockId=0,this.OwnList=[],this.type=0,this.ChooseId=0}onAwake(){"battle"==D.CfgMgr.openScene&&D.UIMgr.closeUI(P.SkinUI),D.CfgMgr.openScene="skin",this.initView(),this.initEvent()}initView(){o.createBannerAd(),D.SceneMgr.changeToSkinCarme(),G.instance.SkinBtn.visible=!1,this.refrshList(1),this.ChooseId=D.DataMgr.UseSkin,this.SkinArr.renderHandler=new Laya.Handler(this,this.onlistRender),this.SkinArr.mouseHandler=new Laya.Handler(this,this.onClickRender),this.SkinArr.vScrollBarSkin=""}initEvent(){this.CloseBtn.on("click",this,this.clickClose),this.SkinBox.on("click",this,this.refrshList,[1]),this.AttackBox.on("click",this,this.refrshList,[2]),this.Shield.on("click",this,this.refrshList,[3]),this.GetAD.on("click",this,this.GetAdClick)}GetAdClick(){D.SoundMgr.playBtnClick(),o.createRewardedVideoAd(e=>{if(e){if(!this)return;D.DataMgr.addGoldCount(150),G.instance.refreshGold()}})}refrshList(e){switch(e){case 1:this.SkinListArr=D.CfgMgr.skinCfg,this.LockId=D.DataMgr.LockOwnSkin,this.OwnList=D.DataMgr.GetOwnSkin,this.SkinBox.getChildByName("light").visible=!0,this.AttackBox.getChildByName("light").visible=!1,this.Shield.getChildByName("light").visible=!1;break;case 2:this.SkinListArr=D.CfgMgr.SwordCfg,this.LockId=D.DataMgr.LockOwnSword,this.OwnList=D.DataMgr.GetOwnSword,this.SkinBox.getChildByName("light").visible=!1,this.AttackBox.getChildByName("light").visible=!0,this.Shield.getChildByName("light").visible=!1;break;case 3:this.SkinListArr=D.CfgMgr.ShieldCfg,this.LockId=D.DataMgr.LockOwnShield,this.OwnList=D.DataMgr.GetOwnShield,this.SkinBox.getChildByName("light").visible=!1,this.AttackBox.getChildByName("light").visible=!1,this.Shield.getChildByName("light").visible=!0}this.type=e,this.SkinArr.array=this.SkinListArr,this.SkinArr.refresh()}onlistRender(e,t){let i=e.getChildByName("icon"),a=e.getChildByName("bg"),n=a.getChildByName("AdBox"),s=a.getChildByName("GoldBox"),o=e.getChildByName("iconbg");n.getChildAt(1).text=U.getName("免费获得"),i.skin="game/"+this.SkinListArr[t].Icon+".png",a.visible=!D.CfgMgr.CheckIsOwn(t,this.OwnList),this.ChooseId===t?o.skin="game/skin_bg0.png":o.skin="game/skin_bg1.png",t==this.LockId?(n.visible=!0,s.visible=!1):(n.visible=!1,s.visible=!0),s.getChildAt(1).text=this.SkinListArr[t].gold}onClickRender(e,t){if(D.SoundMgr.playBtnClick(),"click"!=e.type)return;this.ChooseId=t;let i=this;D.CfgMgr.CheckIsOwn(t,this.OwnList)?(this.setUseId(t),this.SkinArr.refresh()):t==this.LockId?o.createRewardedVideoAd(function(e){if(e){if(!i)return;D.CfgMgr.ChangeLockId(i.ChooseId,i.OwnList,i.type),i.setUseId(t),i.ChangeSkin()}}):this.BuySkin(t)}setUseId(e){switch(this.type){case 1:D.DataMgr.UseSkin=e;break;case 2:D.DataMgr.UseSword=e;break;case 3:D.DataMgr.UseShield=e}D.SceneMgr.changeMainRole(D.SceneMgr.MainRole,null)}BuySkin(e){D.SoundMgr.playBtnClick();let t=this.SkinListArr[e].gold;t>D.DataMgr.goldCount?D.UIMgr.showTips(U.getName("金币不足")):(D.DataMgr.addGoldCount(-t),G.instance.refreshGold(),this.setUseId(e),this.ChangeSkin())}ChangeSkin(){switch(this.type){case 1:D.DataMgr.SetOwnSkin=this.ChooseId;break;case 2:D.DataMgr.SetOwnSword=this.ChooseId;break;case 3:D.DataMgr.SetOwnShield=this.ChooseId}this.refrshList(this.type),this.SkinArr.refresh()}clickClose(){G.instance.LOGO.visible=!1,G.instance.SkinBtn.visible=!0,D.SceneMgr.changeToMainCarme(),this.close()}close(){o.closeBannerAd(),D.SoundMgr.playBtnClick(),super.close()}}class E{constructor(){}static init(){var e=Laya.ClassUtils.regClass;e("script/view/BattleUI.ts",T),e("script/view/Dial.ts",R),e("script/view/GameUI.ts",G),e("script/view/LoadingUI.ts",O),e("script/view/SevenDay.ts",V),e("script/view/SkinUI.ts",z)}}E.width=720,E.height=1280,E.scaleMode="fixedwidth",E.screenMode="none",E.alignV="top",E.alignH="left",E.startScene="view/GameUI.scene",E.sceneRoot="",E.debug=!1,E.stat=!1,E.physicsDebug=!1,E.exportSceneToJson=!0,E.init();new class{constructor(){window.Laya3D?Laya3D.init(E.width,E.height):Laya.init(E.width,E.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=E.scaleMode,Laya.stage.screenMode=E.screenMode,Laya.stage.frameRate=Laya.Stage.FRAME_FAST,Laya.URL.exportSceneToJson=E.exportSceneToJson,Laya.SoundManager.useAudioMusic=!1,(E.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),E.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),Laya.alertGlobalError=!0,o.initializeAsync(()=>{Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)})}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){D.SetupEngine(),D.DataMgr.init(),D.CfgMgr.initConfigs(),o.launchInfo(),D.SoundMgr.playBGM(),n.CDN,n.Version,Laya.Browser.onPC,Laya.loader.load("res/atlas/loading.atlas",Laya.Handler.create(this,()=>{console.log("loading 图集加载完毕"),D.UIMgr.toUI(P.LoadingUI)}))}}}();